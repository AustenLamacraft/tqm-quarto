<!DOCTYPE html>
<html lang="en"><head>
<link href="../favicon-32x32.png" rel="icon" type="image/png">
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.8.24">

  <title>Theories of Quantum Matter – Response and Correlation</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto-db84968dd3a81be0f114100d4bbaf104.css">
  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Response and Correlation</h1>

<div class="quarto-title-authors">
</div>

</section>
<section class="slide level2 center">

<div class="hidden">
<!-- See https://stackoverflow.com/questions/76398554/how-to-define-latex-macros-globally-for-a-quarto-book -->
<!-- \DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\E}{\mathbb{E}} -->
</div>
</section>
<section>
<section id="response-correlation" class="title-slide slide level1 center">
<h1>Response &amp; Correlation</h1>
<ul>
<li><p>Calculating eigenstates and eigenenergies is one thing, but what do experimentalists actually measure?</p></li>
<li><p>Want to understand how many body systems <em>respond</em> dynamically to an external probe</p></li>
<li><p>Time evolution of <em>spontaneous fluctuations</em> (thermal or quantum) obeys similar dynamics <span class="math inline">\longrightarrow</span> <strong>fluctuation–dissipation relation</strong></p></li>
</ul>
</section>
<section class="slide level2 center">

<h3 id="quantum-fluctuations-one-oscillator">Quantum fluctuations: one oscillator</h3>
<ul>
<li>For a single (undamped) oscillator we have ground state fluctuations <span class="math display">
H = \frac{p^2}{2m} + \frac{1}{2}m\omega_0^2 y^2
</span> <span class="math display">
\langle{0}\rvert y^2 \lvert{0}\rangle = \frac{1}{2m \omega_0}
</span></li>
</ul>
</section>
<section class="slide level2 center">

<ul>
<li><p>At finite temperature <span class="math display">
\langle\langle y^2\rangle\rangle=\tr\left[\rho\\, y^2\right] = \frac{\coth(\beta\omega_0/2)}{2m\omega_0}
</span> <span class="math inline">\rho = e^{-\beta H}/Z</span> is equilibrium density matrix, and <span class="math inline">Z=\tr[e^{-\beta H}]</span> is partition function</p></li>
<li><p>The double angular brackets <span class="math inline">\langle\langle (\cdots)\rangle\rangle</span> denote that we are taking quantum <em>and thermal</em> expectations.</p></li>
</ul>
</section>
<section class="slide level2 center">

<ul>
<li><p>What about <em>time dependent fluctuations</em>? A natural candidate: <span class="math display">
\langle\langle y(t)y(0)\rangle\rangle,
</span> <span class="math inline">y(t) = e^{iHt} y e^{-iHt}</span> (Heisenberg picture)</p></li>
<li><p>This gives the <em>quantum</em> noise spectrum</p></li>
</ul>
<p><span class="math display">
S(\omega) = \int_{-\infty}^\infty \langle\langle y(t)y(0)\rangle\rangle e^{i\omega t}\,dt.
</span></p>
<ul>
<li><strong>BUT</strong>: since <span class="math inline">y(0)</span> and <span class="math inline">y(t)</span> do not commute with each other <span class="math inline">\langle\langle y(t)y(0)\rangle\rangle\neq \langle\langle y(0)y(t)\rangle\rangle=\langle\langle y(-t)y(0)\rangle\rangle</span>, so</li>
</ul>
<p><span class="math display">
S(\omega)\neq S(-\omega)
</span></p>
</section>
<section class="slide level2 center">

<ul>
<li><p>Many of the properties of <span class="math inline">S(\omega)</span> are most easily understood from <strong>spectral representation</strong></p></li>
<li><p>Insert complete set of energy eigenstates between <span class="math inline">y(0)</span> and <span class="math inline">y(t)</span></p></li>
</ul>
<p><span class="math display">
S(\omega) = 2\pi\sum_{m,n} \frac{e^{-\beta E_n}}{Z} |\langle{n}\rvert y\lvert{m}\rangle|^2 \delta(\omega-E_m+E_n)
</span></p>
<ul>
<li>Reason for asymmetry in <span class="math inline">S(\omega)</span> is that term with <span class="math inline">\delta(\omega-E_m+E_n)</span> is weighted by <span class="math inline">e^{-\beta E_n}</span>, while term with <span class="math inline">\delta(\omega-E_n+E_m)</span> has <span class="math inline">e^{-\beta E_m}</span></li>
</ul>
<p><span class="math display">
S(\omega) = S(-\omega) e^{\beta\omega}.
</span></p>
</section>
<section class="slide level2 center">

<ul>
<li><p>At zero temperature <span class="math inline">\beta\to\infty</span> and we can see that <span class="math inline">S(\omega&lt;0)=0</span>.</p></li>
<li><p>Let’s evaluate <span class="math inline">S(\omega)</span> for oscillator. The matrix elements are <span class="math display">
\langle{n}\rvert y\lvert{m}\rangle = \frac{1}{\sqrt{2m\omega_0}}\begin{cases}
\sqrt{m+1} &amp; \text{if } n=m+1 \\
\sqrt{m} &amp; \text{if } n=m-1.
\end{cases}
</span> <span class="math display">
\begin{align*}
S(\omega)&amp;=\frac{\pi}{m\omega_0} \sum_n \frac{e^{-\beta E_n}}{Z} \left[n\delta(\omega+\omega_0)+(n+1)\delta(\omega-\omega_0)\right]\nonumber\\
&amp; = \frac{\pi}{m\omega_0}\left[n_\text{B}(\omega_0)\delta(\omega+\omega_0)+(n_\text{B}(\omega_0)+1)\delta(\omega-\omega_0)\right]
\end{align*}
</span> <span class="math display">
n_\text{B}(\omega)\equiv \frac{1}{\exp\left(\beta\omega\right)-1}
</span> is Bose distribution function</p></li>
</ul>
</section>
<section class="slide level2 center">

<p><span class="math display">
\begin{align*}
S(\omega)&amp;=\frac{\pi}{m\omega_0} \sum_n \frac{e^{-\beta E_n}}{Z} \left[n\delta(\omega+\omega_0)+(n+1)\delta(\omega-\omega_0)\right]\nonumber\\
&amp; = \frac{\pi}{m\omega_0}\left[n_\text{B}(\omega_0)\delta(\omega+\omega_0)+(n_\text{B}(\omega_0)+1)\delta(\omega-\omega_0)\right]
\end{align*}
</span></p>
<ul>
<li>Shows the predicted asymmetry between positive and negative frequencies. We can check that <span class="math display">
\int S(\omega)\frac{d\omega}{2\pi} = \langle\langle y^2\rangle\rangle= \frac{\coth(\beta\omega_0/2)}{2m\omega_0}
</span> as we found before.</li>
</ul>
</section>
<section class="slide level2 center">

<h3 id="classical-limit-betaomegato-0">Classical limit <span class="math inline">\beta\omega\to 0</span></h3>
<p><span class="math display">
\begin{align*}
S(\omega)&amp;= \frac{\pi}{m\omega_0}\left[n_\text{B}(\omega_0)\delta(\omega+\omega_0)+(n_\text{B}(\omega_0)+1)\delta(\omega-\omega_0)\right]\\\\
&amp;\to \frac{k_\text{B}T}{2m\omega_0^2} \times 2\pi\left[\delta(\omega+\omega_0)+\delta(\omega-\omega_0)\right]
\end{align*}
</span></p>
<ul>
<li>Consistent with equipartition: <span class="math inline">\frac{1}{2}m\omega_0^2 \langle y^2\rangle=\frac{1}{2}k_\text{B}T</span></li>
</ul>
</section>
<section class="slide level2 center">

<h3 id="many-oscillators">Many oscillators</h3>
<ul>
<li>We can express <span class="math inline">y(t)</span> in terms of normal modes as <span class="math display">
y(t) = \sum_k \left[c^{}_k a^\dagger_k(t) + c_k^* a^{\vphantom{\dagger}}_k(t)\right]
</span></li>
<li>Time evolution of mode operators is</li>
</ul>
<p><span class="math display">
a^\dagger_k(t) = e^{i\omega_k t}a^\dagger_k,\quad a^{\vphantom{\dagger}}_k(t) = e^{-i\omega_k t}a^{\vphantom{\dagger}}_k
</span></p>
<ul>
<li>Repeating calculation of <span class="math inline">S(\omega)</span> gives</li>
</ul>
<p><span class="math display">
\begin{align*}
S(\omega)= 2\pi\sum_k |c_k|^2\left[n_\text{B}(\omega_k)\delta(\omega+\omega_k)+(n_\text{B}(\omega_k)+1)\delta(\omega-\omega_k)\right]
\end{align*}
</span></p>
<ul>
<li>In continuum limit sum of <span class="math inline">\delta(\omega\pm\omega_k)\longrightarrow</span> smooth <span class="math inline">S(\omega)</span></li>
</ul>
</section>
<section class="slide level2 center">

<h3 id="response-of-oscillator-system">Response of oscillator system</h3>
<ul>
<li><p>Solve Heisenberg equations of motion <span class="math display">
H = \sum_k \omega_k a^\dagger_ka^{\vphantom{\dagger}}_k - f(t)y,
</span> where <span class="math inline">y</span> is written in terms of normal modes <span class="math display">
\frac{da^{\vphantom{\dagger}}_k}{dt} = -i\omega_k a^{\vphantom{\dagger}}_k +i c_k f(t),
</span></p></li>
<li><p>Solution is <span class="math inline">a^{\vphantom{\dagger}}_k(t) = e^{-i\omega_k t}a^{\vphantom{\dagger}}_k(0)+a_{k,f}(t)</span> with <span class="math display">
a^{\vphantom{\dagger}}_{k,f}(\omega) \equiv \frac{c_k}{\omega_k-\omega-i0} f(\omega).
</span> (<span class="math inline">-i0</span> introduced for response analytic in UHP i.e.&nbsp;causal)</p></li>
</ul>
</section>
<section class="slide level2 center">

<ul>
<li>Response of <span class="math inline">a^{\vphantom{\dagger}}_k(t)\longrightarrow y(t)</span> gives</li>
</ul>
<p><span class="math display">
y(\omega) = \sum_k |c_k|^2\left[\frac{1}{\omega_k-\omega-i0}+\frac{1}{\omega_k+\omega+i0}\right]f(\omega).
</span></p>
<ul>
<li><p>This defines the <strong>response function</strong> <span class="math inline">\chi(\omega)</span> <span class="math display">
\chi(\omega)\equiv \frac{y(\omega)}{f(\omega)} = \sum_k |c_k|^2\left[\frac{1}{\omega_k-\omega-i0}+\frac{1}{\omega_k+\omega+i0}\right]
</span></p></li>
<li><p>Then use…</p></li>
</ul>
<p><span class="math display">
\text{Im} \frac{1}{x\mp i0} = \pm\pi\delta(x),
</span></p>
</section>
<section class="slide level2 center">

<p><span class="math display">
\operatorname{Im}\chi(\omega) =\mathrm{sgn}(\omega)\pi\sum_k |c_k|^2\delta(\omega_k-\omega)
</span></p>
<ul>
<li><span class="math inline">S(\omega)</span> and <span class="math inline">\operatorname{Im}\chi(\omega)</span> are then related by</li>
</ul>
<p><span class="math display">
S(\omega) = 2\operatorname{Im}\chi(\omega)\left[n_\text{B}(\omega)+1\right]
</span></p>
<ul>
<li>This is a <strong>quantum fluctuation dissipation relation</strong></li>
</ul>
</section>
<section class="slide level2 center">

<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Check</strong></p>
</div>
<div class="callout-content">
<p>Check that in the classical limit (<span class="math inline">k_\text{B}T\gg \hbar \omega</span>) <span class="math display">
S(\omega) = 2\operatorname{Im}\chi(\omega)\left[n_\text{B}(\omega)+1\right]
</span> reduces to <span class="math display">
S(\omega)=\frac{2k_\text{B}T}{\omega} \operatorname{Im}\chi(\omega)
</span> Consistent with classical equipartition</p>
</div>
</div>
</div>
</section>
<section class="slide level2 center">

<h3 id="golden-rule-and-dissipation">Golden Rule and Dissipation</h3>
<ul>
<li><p>We saw that classically <span class="math inline">\text{Im}\,\chi(\omega)</span> related to dissipation</p></li>
<li><p>FDT relates <span class="math inline">\operatorname{Im}\chi(\omega)</span> and <span class="math inline">S(\omega)</span>. How is <span class="math inline">S(\omega)</span> related to dissipation?</p></li>
<li><p>Regard driving force as perturbation that causes transitions between energy eigenstates <span class="math display">
H_\text{pert} = - f(t)y
</span> with <span class="math inline">f(t)=f_0\cos\omega t</span></p></li>
</ul>
</section>
<section class="slide level2 center">

<ul>
<li><p>In lowest order perturbation theory, system makes transitions <span class="math inline">\pm\omega</span> in energy</p></li>
<li><p>Rates found from Fermi’s golden rule</p></li>
</ul>
<p><span class="math display">
\Gamma_{n\to m} = 2\pi \left(\frac{f_0}{2}\right)^2|\langle{n}\rvert y\lvert{m}\rangle|^2 \delta(\pm\omega+E_m-E_n).
</span></p>
<ul>
<li><p>Total rate is sum over all initial (<span class="math inline">\lvert{n}\rangle</span>) and final states (<span class="math inline">\lvert{m}\rangle</span>), including probability <span class="math inline">e^{-\beta E_n}/Z</span> of finding the system initially in <span class="math inline">\lvert{n}\rangle</span></p></li>
<li><p>c.f. spectral representation of <span class="math inline">S(\omega)</span></p></li>
</ul>
<p><span class="math display">
S(\omega) = 2\pi\sum_{m,n} \frac{e^{-\beta E_n}}{Z} |\langle{n}\rvert y\lvert{m}\rangle|^2 \delta(\omega-E_m+E_n)
</span></p>
<p><span class="math display">
\Gamma(\omega) = S(\omega)\left(\frac{f_0}{2}\right)^2
</span></p>
</section>
<section class="slide level2 center">

<ul>
<li><p><span class="math inline">S(\omega)</span> measures rate of transitions <em>absorbing</em> energy <span class="math inline">\omega</span>; <span class="math inline">S(-\omega)</span> the rate for <em>emitting</em> energy <span class="math inline">\omega</span>.</p></li>
<li><p>Asymmetry of <span class="math inline">S(\omega)</span> is asymmetry between emission and absorption of radiation</p></li>
<li><p>The rate of energy absorption is</p></li>
</ul>
<p><span class="math display">
\omega\Gamma(\omega) = \omega S(\omega)\left(\frac{f_0}{2}\right)^2 = \frac{1}{2}\omega\operatorname{Im}\chi(\omega)\left[n_\text{B}(\omega)+1\right]f_0^2
</span></p>
</section>
<section class="slide level2 center">

<p><span class="math display">
\omega\Gamma(\omega) = \omega S(\omega)\left(\frac{f_0}{2}\right)^2 = \frac{1}{2}\omega\operatorname{Im}\chi(\omega)\left[n_\text{B}(\omega)+1\right]f_0^2
</span></p>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Check</strong></p>
</div>
<div class="callout-content">
<p>Compare with <span class="math display">
\begin{align*}
W_\text{diss} = \langle f(t) \dot y(t)\rangle = \frac{1}{2}\omega\operatorname{Im}\chi(\omega)f_0^2
\end{align*}
</span> They agree when <span class="math inline">n_\text{B}(\omega)\to 0</span>: energy of transition being much larger than thermal energy <span class="math inline">\hbar\omega\gg k_B T</span>.</p>
</div>
</div>
</div>
</section>
<section id="linear-response-formal-theory" class="slide level2 center">
<h2>Linear Response: Formal Theory</h2>
<ul>
<li><p>So far, considered only response of <em>linear systems</em>!</p></li>
<li><p>How do we talk about linear response <em>in general</em>?</p></li>
</ul>
</section>
<section class="slide level2 center">

<h3 id="kubo-formula">Kubo Formula</h3>
<ul>
<li>How does observable <span class="math inline">A</span> depend on <span class="math inline">\lambda_t</span>, which appears (for small variations) linearly in the Hamiltonian</li>
</ul>
<p><span class="math display">
H_t = H_0 - \lambda_t B?
</span></p>
<ul>
<li><span class="math inline">B=-\frac{\partial H}{\partial \lambda}</span> is <strong>generalized force</strong>; <span class="math inline">\lambda</span> <strong>generalized displacement</strong></li>
</ul>
</section>
<section class="slide level2 center">

<ul>
<li><p>In the interaction picture <span class="math inline">\lvert{\Psi_I(t)}\rangle \equiv e^{iH_0 t}\lvert{\Psi(t)}\rangle</span> <span class="math display">
i\frac{\partial \lvert{\Psi_I(t)}\rangle}{\partial t} = -\lambda_t B_I(t) \lvert{\Psi_I(t)}\rangle,
</span> where <span class="math inline">B_I(t) = e^{iH_0 t}B e^{-iH_0 t}</span></p></li>
<li><p>Result of first order time dependent perturbation theory is <span class="math inline">\lvert{\Psi_I(t)}\rangle=\lvert{\Psi(0)}\rangle+\lvert{\Psi^{(1)}_I(t)}\rangle+\cdots</span>, with</p></li>
</ul>
<p><span class="math display">
\lvert{\Psi^{(1)}_I(t)}\rangle = i\int_0^t dt' \lambda_{t'} B_I(t') \lvert{\Psi(0)}\rangle
</span></p>
<p><span class="math display">
\begin{align*}
&amp;\Braket{\Psi(t)|A|\Psi(t)} = \Braket{\Psi_I(t)|A_I(t) |\Psi_I(t)} \nonumber\\
&amp;=\Braket{\Psi(0)|A_I(t)|\Psi(0)} +i \int_0^t dt' \lambda_{t'}\Braket{\Psi(0)| \left[A_I(t),B_I(t')\right] |\Psi(0)}
\end{align*}
</span></p>
</section>
<section class="slide level2 center">

<ul>
<li><p>Mixed states can be treated by averaging over a distribution of quantum states <span class="math inline">\langle\cdots \rangle \longrightarrow \langle\langle\cdots\rangle\rangle</span></p></li>
<li><p><span class="math inline">\chi_{AB}(t)</span> of <span class="math inline">A</span> due to perturbation that couples to <span class="math inline">B</span></p></li>
</ul>
<p><span class="math display">
\chi_{AB}(t) = i\langle\langle\left[A_I(t),B_I(0)\right]\rangle\rangle,\quad t&gt;0.
</span> (Normally write <span class="math inline">A(t)</span> rather than <span class="math inline">A_I(t)</span>: Heisenberg picture for the unperturbed problem)</p>
<ul>
<li>This is the <strong>Kubo formula</strong>. It expresses the response of a system in terms of the dynamics of the unperturbed system.</li>
</ul>
</section>
<section class="slide level2 center">

<h3 id="fluctuation-dissipation-theorem-general">Fluctuation Dissipation Theorem (general)</h3>
<ul>
<li>Start from the correlation function</li>
</ul>
<p><span class="math display">
S_{AB}(t) \equiv \langle\langle A_I(t)B_I(0)\rangle\rangle
</span></p>
<ul>
<li>Recalling that <span class="math inline">\langle\langle\cdots \rangle\rangle = \frac{1}{Z}\tr\left[e^{-\beta H}\cdots\right]</span>, you should be able to show that</li>
</ul>
<p><span class="math display">
S_{AB}(t) = S_{BA}(-t-i\beta)
</span></p>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Check</strong></p>
</div>
<div class="callout-content">
<p>Hint: use the cyclic property of the trace.</p>
</div>
</div>
</div>
</section>
<section class="slide level2 center">

<p><span class="math display">
S_{AB}(t) = S_{BA}(-t-i\beta).
</span></p>
<ul>
<li>Fourier transforming, we arrive at</li>
</ul>
<p><span class="math display">
S_{AB}(\omega) = e^{\beta\omega} S_{BA}(-\omega)
</span> (we’ve seen this before!)</p>
<ul>
<li><span class="math inline">\chi_{AB}(t)</span> (a commutator) can be written in terms of <span class="math inline">S_{AB}(\omega)</span></li>
</ul>
<p><span class="math display">
\begin{align*}
\chi_{AB}(t) &amp;= \begin{cases}
i\left[S_{AB}(t)-S_{BA}(-t)\right] &amp; t&gt;0\\
0 &amp; t&lt;0
\end{cases}\\
&amp;= i\theta(t)\left[S_{AB}(t)-S_{BA}(-t)\right]
\end{align*}
</span></p>
</section>
<section class="slide level2 center">

<p><span class="math display">
\chi_{AB}(t)=i\theta(t)\left[S_{AB}(t)-S_{BA}(-t)\right]
</span></p>
<ul>
<li><span class="math inline">\chi_{AB}(\omega)</span> can then be expressed as the convolution. The Fourier transform of the step function is</li>
</ul>
<p><span class="math display">
\tilde\theta(\omega) = \frac{i}{\omega+i0}
</span> <span class="math display">
\begin{align*}
\chi_{AB}(\omega)&amp;= -\int \frac{d\omega'}{2\pi}\frac{S_{AB}(\omega')-S_{BA}(-\omega')}{\omega-\omega'+i0}\\
&amp;=-\int \frac{d\omega'}{2\pi}\frac{S_{AB}(\omega')\left[1-e^{-\beta\omega'}\right]}{\omega-\omega'+i0}
\end{align*}
</span></p>
</section>
<section class="slide level2 center">

<ul>
<li>To make sense of this formula, use the Kramers–Kronig relation <span class="math display">
\begin{align*}
\chi_{AB}(\omega) &amp;=\operatorname{Re}\chi_{AB}(\omega) + i\operatorname{Im}\chi_{AB}(\omega)\\
&amp;= \mathcal{P}\int_{-\infty}^\infty \frac{d\omega'}{\pi}\frac{\operatorname{Im}\chi_{AB}(\omega')}{\omega'-\omega} + i\operatorname{Im}\chi_{AB}(\omega)\\
&amp;= \int_{-\infty}^\infty \frac{d\omega'}{\pi}\frac{\operatorname{Im}\chi_{AB}(\omega')}{\omega'-\omega-i0},
\end{align*}
</span> where we used <span class="math display">
\frac{1}{x+i0} = \mathcal{P}\frac{1}{x} -i\pi\delta(x)
</span></li>
<li>Finally! <span class="math display">
S_{AB}(\omega) = 2\operatorname{Im}\chi_{AB}(\omega)\left[n_\text{B}(\omega)+1\right]
</span></li>
</ul>
</section>
<section class="slide level2 center">

<h3 id="spectral-representation">Spectral Representation</h3>
<p>The quantites <span class="math inline">\chi_{AB}(\omega)</span> and <span class="math inline">S_{AB}(\omega)</span> have spectral representations in terms of energy eigenstates and eigenvalues</p>
<p><span class="math display">
S_{AB}(\omega)  = 2\pi\sum_{m,n} \frac{e^{-\beta E_m}}{Z} \Braket{m|A|n}\Braket{n|B|m} \delta(\omega-E_n+E_m)
</span></p>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Check</strong></p>
</div>
<div class="callout-content">
<p>Use the spectral representation to prove the fluctuation dissipation relation</p>
</div>
</div>
</div>
<ul>
<li><span class="math inline">S_{AA}(\omega)</span> can be interpreted in terms of Fermi golden rule, as we saw for oscillator. Notice that <span class="math inline">S_{AA}(\omega)&gt;0</span></li>
</ul>
</section>
<section id="response-of-matter" class="slide level2 center">
<h2>Response of Matter</h2>
<ul>
<li>Back to many body physics!</li>
</ul>
</section>
<section class="slide level2 center">

<h3 id="density-response">Density Response</h3>
<ul>
<li>Apply time dependent potential corresponding to term in Hamiltonian</li>
</ul>
<p><span class="math display">
H_\text{pert} = \sum_{j=1}^N V(\mathbf{r}_i,t) = \int  V(\mathbf{r},t)\rho(\mathbf{r})\, d\mathbf{r}= \frac{1}{L^3}\sum_\mathbf{q}V_\mathbf{q}(t) \rho_{-\mathbf{q}}
</span></p>
<ul>
<li><p>Perturbation couples to the density: how is density affected?</p></li>
<li><p>In a translationally invariant system</p></li>
</ul>
<p><span class="math display">
\langle\langle \rho_\mathbf{q}(t)\rangle\rangle = -\frac{1}{L^3} \int_{-\infty}^t  \chi^{\rho}_\mathbf{q}(t-t') V_\mathbf{q}(t)\,dt',
</span></p>
<p>where the density response function <span class="math inline">\chi^\rho_\mathbf{q}(t)</span> is</p>
<p><span class="math display">
\chi_\rho(\mathbf{q},t) = i\langle\langle\left[\rho_\mathbf{q}(t),\rho_{-\mathbf{q}}(0)\right]\rangle\rangle
</span></p>
</section>
<section class="slide level2 center">

<ul>
<li><p>General theory applies with <span class="math inline">A=\rho_\mathbf{q}</span> and <span class="math inline">B=\rho_{-\mathbf{q}}</span>. At <span class="math inline">T=0</span> <span class="math display">
S_\rho(\mathbf{q},\omega) = 2\pi\sum_{n}  |\langle{0}\rvert\rho_\mathbf{q}\lvert{n}\rangle|^2 \delta(\omega-E_n+E_0)
</span></p></li>
<li><p>This is the <strong>dynamical structure factor</strong>, on account of its importance in scattering experiments.</p></li>
<li><p>The <strong>static structure factor</strong> is <span class="math display">
S_\rho(\mathbf{q}) = \int S_\rho(\mathbf{q},\omega) \frac{d\omega}{2\pi} = \langle\langle\rho_\mathbf{q}\rho_{-\mathbf{q}}\rangle\rangle
</span></p></li>
</ul>
</section>
<section class="slide level2 center">

<h3 id="sum-rules">Sum rules</h3>
<ul>
<li><p><span class="math inline">S_\rho(\mathbf{q},\omega)</span> obeys certain general relations irrespective of system</p></li>
<li><p>If interaction depends only on density <span class="math inline">\left[H_\text{int},\rho_\mathbf{q}\right]=0</span></p></li>
<li><p><span class="math inline">\left[H,\rho_\mathbf{q}\right]=\left[T,\rho_\mathbf{q}\right]</span></p></li>
</ul>
<p><span class="math display">
T = -\frac{1}{2m}\sum_{j=1}^N \nabla_i^2
</span></p>
<ul>
<li>Taking <span class="math inline">\rho_\mathbf{q}=\sum_{j=1}^N e^{-i\mathbf{q}\cdot\mathbf{r}_j}</span>, we find</li>
</ul>
<p><span class="math display">
[[H,\rho_\mathbf{q}],\rho_{-\mathbf{q}}] = -\frac{N\mathbf{q}^2}{m}
</span></p>
</section>
<section class="slide level2 center">

<ul>
<li>Evaluate by introducing resolution of the identity <span class="math inline">\sum_n \lvert{n}\rangle\langle{n}\rvert=1</span></li>
</ul>
<p><span class="math display">
\begin{align*}
\braket{0|[[H,\rho_\mathbf{q}],\rho_{-\mathbf{q}}]|0}&amp;=\braket{0|H\rho_\mathbf{q}\rho_{-\mathbf{q}}- \rho_\mathbf{q}H\rho_{-\mathbf{q}}-\rho_{-\mathbf{q}} H\rho_\mathbf{q}+\rho_{-\mathbf{q}}\rho_\mathbf{q}H|0}\\
&amp;=2\sum_n|\langle{0}\rvert\rho_\mathbf{q}\lvert{n}\rangle|^2\left(E_0-E_n\right)
\end{align*}
</span></p>
<ul>
<li>We can relate this to <span class="math inline">S(\mathbf{q},\omega)</span> using spectral representation</li>
</ul>
<p><span class="math display">
S_\rho(\mathbf{q},\omega) = 2\pi\sum_{n}  |\langle{0}\rvert\rho_\mathbf{q}\lvert{n}\rangle|^2 \delta(\omega-E_n+E_0)
</span> to give the <strong>f-sum rule</strong></p>
<p><span class="math display">
\int_{-\infty}^\infty \omega S(\mathbf{q},\omega) \frac{d\omega}{2\pi}= \frac{N\mathbf{q}^2}{2m}
</span></p>
</section>
<section class="slide level2 center">

<h3 id="compressibility-sum-rule">Compressibility sum rule</h3>
<ul>
<li>Compressibility</li>
</ul>
<p><span class="math display">
\beta=-\frac{1}{V}\frac{\partial V}{\partial p}.
</span> (inverse of Bulk modulus)</p>
<ul>
<li><span class="math inline">p = -\frac{\partial E_0}{\partial V}</span> at <span class="math inline">T=0</span>. If <span class="math inline">E_0 = V \epsilon(\rho)</span>, then</li>
</ul>
<p><span class="math display">
\beta^{-1} = \rho^2 \epsilon''(\rho).
</span></p>
</section>
<section class="slide level2 center">

<p><span class="math display">
\beta^{-1} = \rho^2 \epsilon''(\rho).
</span></p>
<ul>
<li>In the presence of a potential <span class="math inline">V(\mathbf{r})</span>, energy density is</li>
</ul>
<p><span class="math display">
\epsilon(\rho_0+\delta\rho) = \frac{1}{2\beta\rho_0^2} \left[\delta\rho\right]^2 + V(\mathbf{r})\delta\rho
</span></p>
<ul>
<li>Minimizing with respect to <span class="math inline">\delta\rho</span> gives</li>
</ul>
<p><span class="math display">
\epsilon(V(\mathbf{r})) = - \frac{\beta\rho_0^2}{2} \left[V(\mathbf{r})\right]^2
</span></p>
<ul>
<li>Compare with perturbation theory</li>
</ul>
</section>
<section class="slide level2 center">

<ul>
<li>Change in energy due to perturbation</li>
</ul>
<p><span class="math display">
\sum_j V_0 \cos(\mathbf{q}\cdot \mathbf{r}_j) = \frac{V_0}{2}\left[\rho_\mathbf{q}+\rho_{-\mathbf{q}}\right]
</span></p>
<ul>
<li>Second order perturbation theory for ground state <span class="math display">
E^{(2)} =\frac{V_0^2}{4} \sum_{n\neq 0} \frac{|\braket{0|\rho_\mathbf{q}|n}|^2}{E_0-E_n} =-\frac{V_0^2}{4}\int_0^\infty \frac{S(\mathbf{q},\omega)}{\omega}\frac{d\omega}{2\pi}
</span> (first order vanishes)</li>
</ul>
</section>
<section class="slide level2 center">

<ul>
<li>Compare with</li>
</ul>
<p><span class="math display">
\epsilon(V(\mathbf{r})) = - \frac{\beta\rho_0^2}{2} \left[V(\mathbf{r})\right]^2
</span></p>
<ul>
<li>This gives the <strong>compressibility sum rule</strong> at zero temperature</li>
</ul>
<p><span class="math display">
\lim_{\mathbf{q}\to 0}\int_0^\infty \frac{S(\mathbf{q},\omega)}{\omega}\frac{d\omega}{2\pi} = \frac{N\rho\beta}{2}.
</span></p>
<ul>
<li>Compressibility sum rule often written in terms of speed of sound <span class="math inline">c = (\beta m \rho)^{-1/2}</span></li>
</ul>
<p><span class="math display">
\lim_{\mathbf{q}\to 0}\int_0^\infty \frac{S(\mathbf{q},\omega)}{\omega}\frac{d\omega}{2\pi} = \frac{N}{2mc^2}.
</span></p>
</section>
<section class="slide level2 center">

<h3 id="single-mode-approximation">Single Mode Approximation</h3>
<ul>
<li><p>Some systems (e.g Bose gases), are well described by <span class="math display">
S_\rho(\mathbf{q},\omega) \sim 2\pi S_\rho(\mathbf{q}) \delta(\omega - \omega(\mathbf{q})),
</span> for low <span class="math inline">\mathbf{q}</span>, where <span class="math inline">\omega(\mathbf{q})</span> is dispersion relation of collective excitations (e.g.&nbsp;Bogoliubov modes)</p></li>
<li><p>In this approximation, f-sum rule tells us that</p></li>
</ul>
<p><span class="math display">
S_\rho(\mathbf{q}) = \frac{N\mathbf{q}^2}{2m\omega(\mathbf{q})}.
</span></p>
</section>
<section class="slide level2 center">

<h3 id="example-1-bec-no-interactions">Example 1: BEC (no interactions)</h3>
<ul>
<li><p>Excitations out of the condensate are free particles <span class="math inline">\omega(\mathbf{q}) = \frac{\mathbf{q}^2}{2m}</span> <span class="math display">
S_\rho(\mathbf{q}) = N.
</span></p></li>
<li><p>Completely uncorrelated particle positions (Poisson statistics).</p></li>
</ul>
</section>
<section class="slide level2 center">

<h3 id="example-2-interacting-bec-elastic-chain">Example 2: interacting BEC / elastic chain</h3>
<ul>
<li><span class="math inline">\omega(\mathbf{q}) = c|\mathbf{q}|</span> i.e.&nbsp;linear dispersion with finite speed of sound</li>
</ul>
<p><span class="math display">
S_\rho(\mathbf{q}) = \frac{N|\mathbf{q}|}{2mc}.
</span></p>
<ul>
<li>Density fluctuations vanish as wavevector goes to zero, indicating long-range correlations between positions in the ground state.</li>
</ul>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Check</strong></p>
</div>
<div class="callout-content">
<p>Check compressibility sum rule</p>
</div>
</div>
</div>
</section>
<section class="slide level2 smaller scrollable" id="references">

<h3 id="example-3-fqhe">Example 3: FQHE</h3>
<ul>
<li>Assuming <strong>single mode approximation</strong></li>
</ul>
<p><span class="math display">
S_\rho(\mathbf{q},\omega) \sim 2\pi S_\rho(\mathbf{q}) \delta(\omega - \omega(\mathbf{q}))
</span></p>
<ul>
<li>Can use <span class="math inline">S_\rho(\mathbf{q})</span> to find dispersion (see e.g. <span class="citation" data-cites="girvin2002quantum">Girvin (<a href="#/references" role="doc-biblioref" onclick="">2002</a>)</span> for FQHE)</li>
</ul>
<p><span class="math display">
\omega(\mathbf{q}) = \frac{N\mathbf{q}^2}{2m S_\rho(\mathbf{q})}
</span></p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="../assets/girvin-sma.png" class="quarto-figure quarto-figure-center" style="width:40.0%"></p>
</figure>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-girvin2002quantum" class="csl-entry" role="listitem">
Girvin, Steven M. 2002. <span>“The Quantum Hall Effect: Novel Excitations and Broken Symmetries.”</span> In <em>Aspects Topologiques de La Physique En Basse Dimension. Topological Aspects of Low Dimensional Systems: Session LXIX. 7–31 July 1998</em>, 53–175. Springer.
</div>
</div>
</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: true,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: true,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
          const outerScaffold = trigger.parentElement.cloneNode(true);
          const codeEl = outerScaffold.querySelector('code');
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/tqm\.tripos\.org");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>