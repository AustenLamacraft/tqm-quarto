<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Bose Gas – Theories of Quantum Matter</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../notes/fermi-gas.html" rel="next">
<link href="../notes/lattice-models.html" rel="prev">
<link href="../favicon-32x32.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../notes/intro.html">Notes</a></li><li class="breadcrumb-item"><a href="../notes/bose-gas.html">Bose Gas</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Theories of Quantum Matter</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TQM Lectures 2024</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Notes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/many-body-wavefunctions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Many Body Wavefunctions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/quantum-hall-effect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quantum Hall Effect</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/elastic-chain.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Elastic Chain</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/spin-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spin Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/second-quantization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A is for Annihilation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/more-second-quantization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">B is for Bunching</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/lattice-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lattice Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/bose-gas.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Bose Gas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/fermi-gas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fermi Gas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/superconductivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Superconductivity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/response-and-correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Response and Correlation</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Slides</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/many-body-wavefunctions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Many Body Wavefunctions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/quantum-hall-effect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quantum Hall Effect</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/elastic-chain.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Elastic Chain</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/spin-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spin Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/second-quantization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A is for Annihilation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/more-second-quantization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">B is for Bunching</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/lattice-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lattice Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/bose-gas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bose Gas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/fermi-gas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fermi Gas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/superconductivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Superconductivity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/response-and-correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Response and Correlation</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Problem Sets</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../problem-sets/problem-set-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Problem Set 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../problem-sets/problem-set-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Problem Set 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../problem-sets/problem-set-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Problem Set 3</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../past-papers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Past Papers</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-grosspitaevskii-approximation" id="toc-the-grosspitaevskii-approximation" class="nav-link active" data-scroll-target="#the-grosspitaevskii-approximation"><span class="header-section-number">1</span> The Gross–Pitaevskii Approximation</a>
  <ul class="collapse">
  <li><a href="#grosspitaevskii-equation" id="toc-grosspitaevskii-equation" class="nav-link" data-scroll-target="#grosspitaevskii-equation"><span class="header-section-number">1.1</span> Gross–Pitaevskii Equation</a></li>
  <li><a href="#some-observables" id="toc-some-observables" class="nav-link" data-scroll-target="#some-observables"><span class="header-section-number">1.2</span> Some Observables</a></li>
  <li><a href="#example-vortex" id="toc-example-vortex" class="nav-link" data-scroll-target="#example-vortex"><span class="header-section-number">1.3</span> Example: Vortex</a></li>
  </ul></li>
  <li><a href="#bogoliubov-theory" id="toc-bogoliubov-theory" class="nav-link" data-scroll-target="#bogoliubov-theory"><span class="header-section-number">2</span> Bogoliubov Theory</a>
  <ul class="collapse">
  <li><a href="#bogoliubov-hamiltonian" id="toc-bogoliubov-hamiltonian" class="nav-link" data-scroll-target="#bogoliubov-hamiltonian"><span class="header-section-number">2.1</span> Bogoliubov Hamiltonian</a></li>
  <li><a href="#bogoliubov-transformation" id="toc-bogoliubov-transformation" class="nav-link" data-scroll-target="#bogoliubov-transformation"><span class="header-section-number">2.2</span> Bogoliubov transformation</a></li>
  <li><a href="#the-ground-state" id="toc-the-ground-state" class="nav-link" data-scroll-target="#the-ground-state"><span class="header-section-number">2.3</span> The Ground State</a></li>
  </ul></li>
  <li><a href="#appendix" id="toc-appendix" class="nav-link" data-scroll-target="#appendix"><span class="header-section-number">3</span> Appendix</a>
  <ul class="collapse">
  <li><a href="#regularizing-the-ground-state-energy" id="toc-regularizing-the-ground-state-energy" class="nav-link" data-scroll-target="#regularizing-the-ground-state-energy"><span class="header-section-number">3.1</span> Regularizing the ground state energy</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../notes/intro.html">Notes</a></li><li class="breadcrumb-item"><a href="../notes/bose-gas.html">Bose Gas</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Bose Gas</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="hidden">
<!-- See https://stackoverflow.com/questions/76398554/how-to-define-latex-macros-globally-for-a-quarto-book -->
</div>
<p>You know that noninteracting bosons form a Bose condensate: we will see how weak interactions alter this picture, and make a connection to the phenomenon of <strong>superfluidity</strong>.</p>
<hr>
<section id="the-grosspitaevskii-approximation" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="the-grosspitaevskii-approximation"><span class="header-section-number">1</span> The Gross–Pitaevskii Approximation</h2>
<p>Our first attack on the problem is variational. It’s very easy to come up with a variational wavefunction for the ground state of a Bose gas: put all the particles in the same single particle state!</p>
<p><span id="eq-gp-wavefn"><span class="math display">\[
\Psi(\mathbf{r}_1,\ldots \mathbf{r}_N) = \prod_{j=1}^N \varphi_0(\mathbf{r}_i)= \frac{1}{\sqrt{N!}}\left(a^\dagger(\varphi_0)\right)^N\lvert{\text{VAC}}\rangle.
\tag{1}\]</span></span></p>
<p>A state with a macroscopic number of particles in a single particle state is known as a <strong>Bose condensate</strong>. You have probably studied the statistical mechanics of an ideal Bose gas before: the main feature is a <strong>condensation temperature</strong> below which macroscopic occupation occurs.</p>
<p>We know that if we have a noninteracting Hamiltonian</p>
<p><span class="math display">\[
H = \sum\left[-\frac{\nabla_i^2}{2m} + V(\mathbf{r}_i)\right],
\]</span></p>
<p>then the ground state has exactly the form <a href="#eq-gp-wavefn" class="quarto-xref">Equation&nbsp;1</a>, with <span class="math inline">\(\varphi_0(\mathbf{r})\)</span> the ground state of the single particle Hamiltonian. After adding interactions to the Hamiltonian, in the form</p>
<p><span class="math display">\[
H_\text{int.} = \sum_{j&lt;k} U(\mathbf{r}_j-\mathbf{r}_k) = \frac{1}{2}\int d\mathbf{r}_1 d\mathbf{r}_2\, U(\mathbf{r}_1-\mathbf{r}_2)\psi^\dagger(\mathbf{r}_1)\psi^\dagger(\mathbf{r}_2)\psi^{\vphantom{\dagger}}(\mathbf{r}_2)\psi^{\vphantom{\dagger}}(\mathbf{r}_1).
\]</span></p>
<p>it is no longer true that the exact ground state has the form <a href="#eq-gp-wavefn" class="quarto-xref">Equation&nbsp;1</a>, but we can treat <span class="math inline">\(\varphi_0(\mathbf{r})\)</span> as a variational function that we must find. This leads to the <strong>Gross–Pitaevskii equation</strong>.</p>
<section id="grosspitaevskii-equation" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="grosspitaevskii-equation"><span class="header-section-number">1.1</span> Gross–Pitaevskii Equation</h3>
<p>From now on we will take a model of short-ranged interactions for simplicity</p>
<p><span class="math display">\[
U(\mathbf{r}-\mathbf{r}') = U_0\delta(\mathbf{r}-\mathbf{r}')
\]</span></p>
<p>To implement the variational calculation we need to find</p>
<p><span class="math display">\[
\langle E \rangle = \frac{\langle{\Psi}\rvert H \lvert \Psi \rangle}{\langle{\Psi}\rvert \Psi \rangle}
\]</span></p>
<p>In fact, it turns out to be more convenient to minimize <span class="math inline">\(\langle{\Psi}\rvert H \lvert \Psi \rangle\)</span>, using a Lagrange multiplier to fix the normalization. We have</p>
<p><span id="eq-energy"><span class="math display">\[
\begin{align}
\langle{\Psi}\rvert H \lvert \Psi \rangle=N \int d\mathbf{r}\left[\frac{1}{2m}|\nabla\varphi_0|^2+V(\mathbf{r})|\varphi_0(\mathbf{r})|^2
\right]\\
+\frac{1}{2}N(N-1)U_0\int d\mathbf{r}|\varphi_0(\mathbf{r})|^4.
\end{align}
\tag{2}\]</span></span></p>
<p>For large <span class="math inline">\(N\)</span>, we can neglect the difference between <span class="math inline">\(N\)</span> and <span class="math inline">\(N+1\)</span>. Now we want to extremize this functional with respect to <span class="math inline">\(\varphi_0(\mathbf{r})\)</span>, keeping <span class="math inline">\(\varphi_{0}(\mathbf{r})\)</span> normalized. To do this we introduce a Lagrange multiplier <span class="math inline">\(\mu N\)</span> (the factor of <span class="math inline">\(N\)</span> will become clear shortly) and extremize the functional</p>
<p><span class="math display">\[
\langle{\Psi}\rvert H \lvert \Psi \rangle - \mu N \int d\mathbf{r}|\varphi_{0}(\mathbf{r})|^{2}.
\]</span></p>
<p>To find the extremum requires a standard application of the calculus of variations, yielding the equation</p>
<p><span id="eq-pre-gpe"><span class="math display">\[
    \left[-\frac{1}{2m}\nabla^2-\mu+V(\mathbf{r})+NU_0|\varphi_0(\mathbf{r})|^2\right]\varphi_0(\mathbf{r})=0.
\tag{3}\]</span></span></p>
<p>It’s convenient to deal with the stray factor of <span class="math inline">\(N\)</span> in <a href="#eq-pre-gpe" class="quarto-xref">Equation&nbsp;3</a> by defining <span class="math inline">\(\varphi(\mathbf{r})\equiv\sqrt{N}\varphi_{0}(\mathbf{r})\)</span>. <span class="math inline">\(\varphi(\mathbf{r})\)</span> is known as the <strong>condensate wavefunction</strong> or <strong>order parameter</strong>. Later we will give a more general definition that does not depend on the above variational approximation. We have thus obtained the <strong>Gross–Pitaevskii equation</strong></p>
<p><span class="math display">\[
\left[-\frac{1}{2m}\nabla^2-\mu+V(\mathbf{r})+U_0|\varphi(\mathbf{r})|^2\right]\varphi(\mathbf{r})=0.
\]</span></p>
<p>It remains to fix the Lagrange multiplier <span class="math inline">\(\mu\)</span>. This is done by demanding that <span class="math inline">\(\int d\mathbf{r}\,\lvert{\varphi(\mathbf{r})}\rvert^{2}=N\)</span>. Since <span class="math inline">\(\langle{\Psi}\rvert H \lvert \Psi \rangle- \mu \int d\mathbf{r}\lvert{\varphi(\mathbf{r})}\rvert^{2}=\langle{\Psi}\rvert H-\mu \mathsf{N} \lvert \Psi \rangle\)</span> was extremized under general variations, including those that changed <span class="math inline">\(N\)</span>, we must have</p>
<p><span class="math display">\[
    \label{bose_static_GPmu}
    \mu=\frac{\partial\langle{\Psi}\rvert H \lvert \Psi \rangle}{\partial N},
\]</span></p>
<p>so that <span class="math inline">\(\mu\)</span> is identified with the chemical potential.</p>
<p>A fundamental effect of the nonlinearity of the GP equation is that there exists a length scale set by the typical value of <span class="math inline">\(|\varphi(\mathbf{r})|^2\sim n\)</span> and the interaction strength</p>
<p><span class="math display">\[
\xi\equiv \frac{1}{\sqrt{2m n U_0}}
\]</span></p>
<p>This <strong>healing length</strong> determines the scale over which <span class="math inline">\(\varphi(\mathbf{r})\)</span> is disturbed by the introduction of a localized potential of scale <span class="math inline">\(\ll \xi\)</span>. It is a fundamental length scale in the system.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>Show that near a hard wall, where the condensate wavefunction goes to zero, <span class="math inline">\(\varphi(\mathbf{r})\)</span> is given by <span class="math display">\[
\varphi(x)=\varphi_{\infty}\tanh \frac{x}{\sqrt{2}\xi}
\]</span></p>
<p>where <span class="math inline">\(x\)</span> is the distance from the wall, and <span class="math inline">\(\varphi_{\infty}=\sqrt{n_{\infty}}\)</span> is fixed by the density of the condensate far from the wall.</p>
</div>
</div>
</section>
<section id="some-observables" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="some-observables"><span class="header-section-number">1.2</span> Some Observables</h3>
<p>With the ansatz <a href="#eq-gp-wavefn" class="quarto-xref">Equation&nbsp;1</a> for the wavefunction, we can obtain various observables without difficulty. The density and current density are</p>
<p><span class="math display">\[
\begin{align}
\rho(\mathbf{r})&amp;=|\varphi(\mathbf{r})|^2,\\
\mathbf{j}(\mathbf{r})&amp;=-\frac{i}{2m}\left[\varphi^{*}(\mathbf{r})\left(\nabla\varphi(\mathbf{r})\right)-\left(\nabla\varphi^{*}(\mathbf{r})\right)\varphi(\mathbf{r})\right]
\end{align}
\]</span></p>
<p>Alternatively, one may write this is terms of the velocity field of the gas, using <span class="math inline">\(\mathbf{j}=\rho \mathbf{v}\)</span>, and the decomposition of <span class="math inline">\(\varphi(\mathbf{r})\)</span> into magnitude and phase</p>
<p><span class="math display">\[
    \varphi(\mathbf{r})=\sqrt{\rho(\mathbf{r})}e^{i\chi(\mathbf{r})}.
\]</span></p>
<p>We thus find the <strong>superfluid velocity</strong></p>
<p><span id="eq-vs"><span class="math display">\[
    \mathbf{v}_{s}\equiv\frac{1}{m}\nabla\chi.
\tag{4}\]</span></span></p>
<p>The name is to distinguish this contribution from that arising from thermal excitations. For the moment we are considering zero temperature, so this is all there is.</p>
<p>The usefulness of the Gross–Pitaevskii equations lies in its ability to describe spatially nonuniform situations. Often, nonuniformity is imposed by an external potential, but there is an important class of configurations that are stable – or metastable – for <em>topological</em> reasons.</p>
</section>
<section id="example-vortex" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="example-vortex"><span class="header-section-number">1.3</span> Example: Vortex</h3>
<p>Since <a href="#eq-vs" class="quarto-xref">Equation&nbsp;4</a> tells us that the superfluid velocity is a gradient of something, we may expect it to be <em>irrotational</em></p>
<p><span class="math display">\[
\nabla\times \mathbf{v}_s = 0,
\]</span></p>
<p>or equivalently to have vanishing <em>circulation</em></p>
<p><span class="math display">\[
\oint \mathbf{v}_s\cdot d\mathbf{l}=0
\]</span></p>
<p>around any closed loop. However, it is possible for the phase of the wavefunction to increase by a multiple of <span class="math inline">\(2\pi\)</span> around a closed loop, which still gives a single-valued condensate wavefunction since <span class="math inline">\(\varphi(\mathbf{r})=\sqrt{\rho(\mathbf{r})}e^{i\chi(\mathbf{r})}\)</span>. Thus in general the circulation</p>
<p><span class="math display">\[
\oint \mathbf{v}_s\cdot d\mathbf{l}=\frac{2\pi \ell}{m},\quad \ell\in\mathbb{Z},
\]</span></p>
<p>which is known as the <strong>Onsager–Feynmann quantization condition</strong>. A localized configuration with finite circulation is called a <strong>vortex</strong> in fluid dynamics, but in a normal fluid there is no reason for the circulation to be quantized. Restoring Planck’s constant just this once</p>
<p><span class="math display">\[
\oint \mathbf{v}_s\cdot d\mathbf{l}=\frac{h\ell}{m},\quad \ell\in\mathbb{Z},
\]</span></p>
<p>shows that this is a truly <em>quantum</em> phenomenon.</p>
<p>A non-zero winding of the phase requires that <span class="math inline">\(\rho(\mathbf{r})\)</span> vanishes at a point (in two dimensions) or on a line (in three). Let’s see how such configurations are described by the Gross–Pitaevskii theory.</p>
<p>We are going to look for 2D solutions where the phase winds <span class="math inline">\(\ell\)</span> times as we encircle the origin</p>
<p><span id="eq-vortex"><span class="math display">\[
\varphi(r,\theta)\xrightarrow{r\to\infty} \sqrt{n} e^{i\ell\theta}.
\tag{5}\]</span></span></p>
<p>We parameterize the solution as <span class="math inline">\(\varphi(r,\theta) = \sqrt{n} f(r/\xi)e^{i\ell\theta}\)</span>, measuring distances in terms of the healing length. Substituting into the Gross–Pitaevskii equation gives an equation in <span class="math inline">\(s\equiv r/\xi\)</span>.</p>
<p><span class="math display">\[
-f'' -\frac{f'}{s} + \frac{\ell^2 f}{s^2} - f +f^3 =0.
\]</span></p>
<p>We take <span class="math inline">\(\mu = U_0 n\)</span> to get the behaviour <a href="#eq-vortex" class="quarto-xref">Equation&nbsp;5</a> at infinity.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>Without finding the solution explicitly, show that <span class="math inline">\(f(s)\sim s^\ell\)</span> for small <span class="math inline">\(s\)</span>, and <span class="math inline">\(f(s\to\infty) \to 1\)</span>.</p>
</div>
</div>
<p>The region of suppressed density, of characteristic size <span class="math inline">\(\xi\)</span>, is called the <strong>vortex core</strong>. In three dimensions, the vortex core is a line.</p>
<p>We can find the energy of the vortex state by substituting the solution back into the energy functional <a href="#eq-energy" class="quarto-xref">Equation&nbsp;2</a> to find the energy excess relative to a uniform state of density <span class="math inline">\(n\)</span></p>
<p><span class="math display">\[
\Delta E = \int d\mathbf{r}\left[\frac{n^2}{2m\xi^2}(f')^2+\frac{U}{2}n^2 \left(f^2-1\right)^2\right] + \frac{n^2}{2m}\int d\mathbf{r}\, f^2(\nabla\chi)^2.
\]</span></p>
<p>The first integral is finite, and arises purely from the departure of the density away from its bulk value. The second represents the contribution to the kinetic energy arising from the winding of the vortex’s phase. Since we have</p>
<p><span class="math display">\[
\nabla \chi = \frac{\ell}{r}\hat{\mathbf{e}}_\theta,
\]</span></p>
<p>this contribution to the energy is <em>logarithmically divergent</em>.</p>
<p><span class="math display">\[
\Delta E = \text{const.} + \frac{\pi n \ell^2}{m}\log\left(\frac{L}{\xi}\right).
\]</span></p>
<p>There is far-reaching analogy between the superfluid velocity fields of vortices and the magnetostatics of current-carrying wires,</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Vortices</th>
<th>Magnetostatics</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Vortex cores</td>
<td>Wires</td>
</tr>
<tr class="even">
<td>Superfluid velocity <span class="math inline">\(\mathbf{v}_s\)</span></td>
<td>Magnetic field, <span class="math inline">\(\mathbf{B}\)</span></td>
</tr>
<tr class="odd">
<td>Kinetic Energy</td>
<td>Magnetostatic Energy</td>
</tr>
</tbody>
</table>
<p>Vortices with <span class="math inline">\(\lvert{\ell}\rvert&gt;1\)</span> are generally unstable, and will break into multiple vortices of winding <span class="math inline">\(\ell=\pm 1\)</span>. Like vortices repel each other, and can form spectacular <strong>vortex lattices</strong>, akin to crystals.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../assets/3dLattices.jpg" class="img-fluid figure-img"></p>
<figcaption>Vortex lattice in a Bose–Einstein condensate of Sodium atoms. Source: <a href="https://ketterle-group.mit.edu/">Ketterle group, MIT</a></figcaption>
</figure>
</div>
<p>Vortices are one manifestation of the phenomenon of <strong>superfluidity</strong>: persistent flow without resistance. The true ground state of the system does not have such flows, of course, so these flows are only <em>metastable</em> (as long as rotational symmetry is broken, so that angular momentum is not conserved). In the case of the vortex, it can only decay by its core leaving the system. An even simpler example is provided by currents flowing in a ring, a situation studied in <a href="../problem-sets/problem-set-2.html#persistent-currents-without-rotational-symmetry">Problem Set 2</a>, which illustrates the important role played by repulsive interactions.</p>
</section>
</section>
<section id="bogoliubov-theory" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="bogoliubov-theory"><span class="header-section-number">2</span> Bogoliubov Theory</h2>
<p>How can we improve upon the Gross–Pitaevskii approximation? From now on we focus on a uniform condensate with no external potential <span class="math inline">\(V(\mathbf{r})\)</span>, in which case the condensate wavefunction is just a constant <span class="math inline">\(\varphi(\mathbf{r})=\sqrt{n}\)</span>. As usual we work in a plane wave basis, where the Hamiltonian takes the form</p>
<p><span class="math display">\[
H =\sum_\mathbf{k}\epsilon(\mathbf{k})a^\dagger_\mathbf{k}a^{\vphantom{\dagger}}_\mathbf{k}+ \overbrace{\frac{U_0}{2V}\sum_{\mathbf{k}_1+\mathbf{k}_2=\mathbf{k}_3+\mathbf{k}_4} a^\dagger_{\mathbf{k}_1}a^\dagger_{\mathbf{k}_2}a^{\vphantom{\dagger}}_{\mathbf{k}_3}a^{\vphantom{\dagger}}_{\mathbf{k}_4}}^{\equiv H_\text{int}},
\]</span></p>
<p>with <span class="math inline">\(\epsilon(\mathbf{k})=\mathbf{k}^2/2m\)</span>, and <span class="math inline">\(V\)</span> the volume. The Gross–Pitaevskii approximation to the ground state is</p>
<p><span class="math display">\[
\lvert{\Psi_\text{GP}}\rangle = \frac{1}{\sqrt{N!}}\left(a^\dagger_0\right)^N\lvert{\text{VAC}}\rangle.
\]</span></p>
<p>When <span class="math inline">\(H_\text{int}\)</span> acts on this state, the only terms that contribute are those with <span class="math inline">\(\mathbf{k}_3=\mathbf{k}_4=0\)</span></p>
<p><span class="math display">\[
H_\text{int}\lvert{\Psi_\text{GP}}\rangle =  \frac{U_0}{2V}\sum_{\mathbf{k}} a^\dagger_{\mathbf{k}}a^\dagger_{-\mathbf{k}}a^{\vphantom{\dagger}}_{0}a^{\vphantom{\dagger}}_{0}\lvert{\Psi_\text{GP}}\rangle.
\]</span></p>
<p>Thus, if we want a better wavefunction, we are going to have to add some <span class="math inline">\((+\mathbf{k}, -\mathbf{k})\)</span> pairs!</p>
<section id="bogoliubov-hamiltonian" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="bogoliubov-hamiltonian"><span class="header-section-number">2.1</span> Bogoliubov Hamiltonian</h3>
<p>When interactions are weak, we expect that the true ground state is close to <span class="math inline">\(\lvert{\Psi_\text{GP}}\rangle\)</span>, so that most of the particles remain in the zero momentum state, with relatively few pairs created. Remembering that</p>
<p><span class="math display">\[
a^{\vphantom{\dagger}}\lvert{N}\rangle = \sqrt{N}\lvert{N-1}\rangle,\quad a^\dagger\lvert{N}\rangle = \sqrt{N+1}\lvert{N+1}\rangle,
\label{bose_aN}
\]</span></p>
<p>we see that a term in the Hamiltonian with <span class="math inline">\(a^{\vphantom{\dagger}}_0\)</span> or <span class="math inline">\(a^\dagger_0\)</span> is going to be more important – on account of the large occupancy of <span class="math inline">\(\mathbf{k}=0\)</span> – than a term without. For this reason we divide up the interaction Hamiltonian according to the number of occurrences of these operators</p>
<p><span class="math display">\[
\begin{align}
H_\text{int} = &amp;\frac{U_0}{2V}a^\dagger_0a^\dagger_0a^{\vphantom{\dagger}}_0a^{\vphantom{\dagger}}_0 \\\nonumber
&amp;+\frac{U_0}{2V}\sum_{\mathbf{k}\neq0}\left[a^\dagger_{\mathbf{k}}a^\dagger_{-\mathbf{k}}a^{\vphantom{\dagger}}_{0}a^{\vphantom{\dagger}}_{0} + a^\dagger_{0}a^\dagger_{0}a^{\vphantom{\dagger}}_{\mathbf{k}}a^{\vphantom{\dagger}}_{-\mathbf{k}}+4a^\dagger_\mathbf{k}a^\dagger_0a^{\vphantom{\dagger}}_0a^{\vphantom{\dagger}}_\mathbf{k}\right]\\\nonumber
&amp;+\frac{U_0}{V}\sum_{\substack{\mathbf{k}_1=\mathbf{k}_2+\mathbf{k}_3\\ \mathbf{k}_{1,2,3}\neq 0}}\left[a^\dagger_{\mathbf{k}_3}a^\dagger_{\mathbf{k}_2}a^{\vphantom{\dagger}}_{\mathbf{k}_1}a^{\vphantom{\dagger}}_0 +a^\dagger_0a^\dagger_{\mathbf{k}_1}a^{\vphantom{\dagger}}_{\mathbf{k}_2}a^{\vphantom{\dagger}}_{\mathbf{k}_3}\right]\\\nonumber
&amp;+\frac{U_0}{2V}\sum_{\substack{\mathbf{k}_1+\mathbf{k}_2=\mathbf{k}_3+\mathbf{k}_4\\ \mathbf{k}_{1,2,3,4}\neq 0}} a^\dagger_{\mathbf{k}_1}a^\dagger_{\mathbf{k}_2}a^{\vphantom{\dagger}}_{\mathbf{k}_3}a^{\vphantom{\dagger}}_{\mathbf{k}_4}.
\end{align}
\]</span></p>
<p>The Gross–Pitaevskii approximation corresponds to the first term. We are now going to additionally keep the second term, and neglect the third and fourth. Thus we study the Hamiltonian</p>
<p><span id="eq-H-pair"><span class="math display">\[
\begin{align}
H_\text{pair} &amp;= \sum_\mathbf{k}\epsilon(\mathbf{k})a^\dagger_\mathbf{k}a^{\vphantom{\dagger}}_\mathbf{k}+\frac{U_0}{2V}a^\dagger_0a^\dagger_0a^{\vphantom{\dagger}}_0a^{\vphantom{\dagger}}_0 \nonumber\\ &amp;\quad+\frac{U_0}{2V}\sum_{\mathbf{k}\neq0}\left[a^\dagger_{\mathbf{k}}a^\dagger_{-\mathbf{k}}a^{\vphantom{\dagger}}_{0}a^{\vphantom{\dagger}}_{0} + a^\dagger_{0}a^\dagger_{0}a^{\vphantom{\dagger}}_{\mathbf{k}}a^{\vphantom{\dagger}}_{-\mathbf{k}}+4a^\dagger_\mathbf{k}a^\dagger_0a^{\vphantom{\dagger}}_0a^{\vphantom{\dagger}}_\mathbf{k}\right].
\end{align}
\tag{6}\]</span></span></p>
<p>The second line describes the movement of pairs between zero momentum and <span class="math inline">\((+\mathbf{k},-\mathbf{k})\)</span>. To separate as much as possible the <span class="math inline">\(\mathbf{k}\neq 0\)</span> modes from the <span class="math inline">\(\mathbf{k}=0\)</span> mode we use</p>
<p><span class="math display">\[
a^\dagger_0a^{\vphantom{\dagger}}_0 = N - N',\quad N'\equiv \sum_{\mathbf{k}\neq 0} N_\mathbf{k}
\]</span></p>
<p>so that</p>
<p><span class="math display">\[
a^\dagger_0a^\dagger_0a^{\vphantom{\dagger}}_0a^{\vphantom{\dagger}}_0 =  N(N-1) - 2N'N_0+O(N_0^0   ).
\]</span></p>
<p>In this way, <a href="#eq-H-pair" class="quarto-xref">Equation&nbsp;6</a> becomes</p>
<p><span id="eq-H-pair-2"><span class="math display">\[
\begin{align}
H_\text{pair} = &amp;N\epsilon(0)+\frac{U_0}{2V}N(N-1) \nonumber\\\nonumber
&amp;+\sum_{\mathbf{k}\neq 0}\left(\left[\epsilon(\mathbf{k})-\epsilon(0)\right]a^\dagger_\mathbf{k}a^{\vphantom{\dagger}}_\mathbf{k}\right.\\
&amp;\left.+\frac{U_0}{2V}\left[a^\dagger_{\mathbf{k}}a^\dagger_{-\mathbf{k}}a^{\vphantom{\dagger}}_{0}a^{\vphantom{\dagger}}_{0} + a^\dagger_{0}a^\dagger_{0}a^{\vphantom{\dagger}}_{\mathbf{k}}a^{\vphantom{\dagger}}_{-\mathbf{k}}+2a^\dagger_\mathbf{k}a^\dagger_0a^{\vphantom{\dagger}}_0a^{\vphantom{\dagger}}_\mathbf{k}\right]\right).
\end{align}
\tag{7}\]</span></span></p>
<p>Even though <span class="math inline">\(\epsilon(0)=0\)</span> for the situation we are interested in right now, we have included the general case in <a href="#eq-H-pair-2" class="quarto-xref">Equation&nbsp;7</a> to emphasize that it is the energy <em>difference</em> between <span class="math inline">\(0\)</span> and <span class="math inline">\(\mathbf{k}\)</span> that is important: any energy offset appears as a constant in the first term.</p>
<p>Even now it’s not so easy to solve this problem. One last vital simplification is needed. We are going to replace the operators <span class="math inline">\(a^\dagger_0\)</span>, <span class="math inline">\(a^{\vphantom{\dagger}}_0\)</span> with <span class="math inline">\(\sqrt{N}\)</span>, giving a quadratic Hamiltonian. That may sound like a pretty odd thing to do: after all, the resulting Hamiltonian no longer conserves the number of particles! Let’s see why this is a good approximation.</p>
<p>Consider the action of the Hamiltonian <a href="#eq-H-pair" class="quarto-xref">Equation&nbsp;6</a> on a product state of the form <span class="math inline">\(\lvert{\Psi'}\rangle\otimes\lvert{N_0}\rangle_0\)</span>, where <span class="math inline">\(\lvert{\Psi'}\rangle\)</span> lives in the many body Hilbert space made from non-zero momentum single particle states and <span class="math inline">\(\lvert{N_0}\rangle_0\)</span> has <span class="math inline">\(N_0\)</span> particles in the zero momentum state.</p>
<p>The action of <span class="math inline">\(a^\dagger_\mathbf{k}a^{\vphantom{\dagger}}_0\)</span> on this state is</p>
<p><span class="math display">\[
\begin{align}
a^\dagger_\mathbf{k}a^{\vphantom{\dagger}}_0\lvert{\Psi'}\rangle\otimes\lvert{N_0}\rangle_0 &amp;= \left(a^\dagger_\mathbf{k}\lvert{\Psi'}\rangle\right)\otimes a^{\vphantom{\dagger}}_0\lvert{N_0}\rangle_0\nonumber\\
&amp;= \left(a^\dagger_\mathbf{k}\lvert{\Psi'}\rangle\right)\otimes \sqrt{N_0}\lvert{N_0-1}\rangle_0.
\end{align}
\]</span></p>
<p>Likewise</p>
<p><span class="math display">\[
\begin{align}
a^{\vphantom{\dagger}}_\mathbf{k}a^\dagger_0\lvert{\Psi'}\rangle\otimes\lvert{N_0}\rangle_0 &amp;= \left(a^{\vphantom{\dagger}}_\mathbf{k}\lvert{\Psi'}\rangle\right)\otimes a^\dagger_0\lvert{N_0}\rangle_0 \nonumber\\
&amp;= \left(a^{\vphantom{\dagger}}_\mathbf{k}\lvert{\Psi'}\rangle\right)\otimes \sqrt{N_0+1}\lvert{N_0+1}\rangle_0.
\end{align}
\]</span></p>
<p>Since <span class="math inline">\(N_0\)</span> is assumed to be large, we ignore the difference between <span class="math inline">\(N_0\)</span> and <span class="math inline">\(N_0+1\)</span>. To be more precise, we are assuming that in the states we are going to find, <span class="math inline">\(N_0\)</span> will not fluctuate substantially. If this is the case, the <em>matrix elements</em> of <span class="math inline">\(H_\text{pair}\)</span> are approximately unchanged when we make the replacement mentioned above, leaving us with the <strong>Bogoliubov Hamiltonian</strong></p>
<p><span id="eq-H-pair-3"><span class="math display">\[
\begin{aligned}
H_\text{pair} &amp;= N\epsilon(0)+\frac{U_0}{2V}N(N-1) \nonumber\\
&amp;+\sum_{\mathbf{k}\neq 0}\left(\left[\tilde\epsilon(\mathbf{k})+U_0n_0\right]a^\dagger_\mathbf{k}a^{\vphantom{\dagger}}_\mathbf{k}+\frac{U_0n_0}{2}\left[a^\dagger_{\mathbf{k}}a^\dagger_{-\mathbf{k}} + a^{\vphantom{\dagger}}_{\mathbf{k}}a^{\vphantom{\dagger}}_{-\mathbf{k}}\right]\right).
\end{aligned}
\tag{8}\]</span></span></p>
<p>where <span class="math inline">\(n_0 = N_0/V\)</span> is the density of particles in the zero momentum state, and we have defined <span class="math inline">\(\tilde\epsilon(\mathbf{k})\equiv\epsilon(\mathbf{k})-\epsilon(0)\)</span>. The Hamiltonian <a href="#eq-H-pair-3" class="quarto-xref">Equation&nbsp;8</a> can be diagonalized by a <strong>Bogoliubov transformation</strong>.</p>
</section>
<section id="bogoliubov-transformation" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="bogoliubov-transformation"><span class="header-section-number">2.2</span> Bogoliubov transformation</h3>
<p>This is a change of variables that arises often in many body physics, so we’ll take some time to introduce it in a general context. Suppose we have a Hermitian operator that is quadratic in two bosons <span class="math inline">\(a^{\vphantom{\dagger}}_{1,2}\)</span> with the following form</p>
<p><span class="math display">\[
h = \epsilon\left[a^\dagger_1a^{\vphantom{\dagger}}_1+a^\dagger_2a^{\vphantom{\dagger}}_2\right] + \delta\left[a^\dagger_1a^\dagger_2+a^{\vphantom{\dagger}}_1a^{\vphantom{\dagger}}_2\right].
\]</span></p>
<p>It’s convenient to write this as</p>
<p><span class="math display">\[
h = \begin{pmatrix}
a^\dagger_1 &amp; a^{\vphantom{\dagger}}_2
\end{pmatrix}
\begin{pmatrix}
\epsilon &amp; \delta \\
\delta &amp; \epsilon
\end{pmatrix}
\begin{pmatrix}
a^{\vphantom{\dagger}}_1 \\ a^\dagger_2
\end{pmatrix}-\epsilon
\]</span></p>
<p>It is possible to express <span class="math inline">\(h\)</span> in terms of some new bosons <span class="math inline">\(b^{\vphantom{\dagger}}_{1,2}\)</span> in the form</p>
<p><span class="math display">\[
h = \Omega\left[b^\dagger_1b^{\vphantom{\dagger}}_1+b^\dagger_2b^{\vphantom{\dagger}}_2\right] +\text{const.}
\]</span></p>
<p>(because then the spectrum is obvious). We look to express the new bosons linearly in terms of the old as follows</p>
<p><span class="math display">\[
\begin{pmatrix}
b^{\vphantom{\dagger}}_1 \\ b^\dagger_2
\end{pmatrix}=
\Lambda
\begin{pmatrix}
a^{\vphantom{\dagger}}_1 \\ a^\dagger_2
\end{pmatrix}
\]</span></p>
<p>where <span class="math inline">\(\Lambda\)</span> is some <span class="math inline">\(2\times 2\)</span> matrix. What conditions should <span class="math inline">\(\Lambda\)</span> satisfy?</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>Show that if we want the new bosons <span class="math inline">\(b^{\vphantom{\dagger}}_{1,2}\)</span> to satisfy the same commutation relations as the original <span class="math inline">\(a_{1,2}\)</span>, we must have <span class="math display">\[
\Lambda^\dagger \sigma_3 \Lambda = \sigma_3
\]</span></p>
</div>
</div>
<p>The following parameterization satisfies this condition and is sufficiently general for our needs</p>
<p><span class="math display">\[
\Lambda=
\begin{pmatrix}
\cosh\kappa &amp; \sinh\kappa \\
\sinh\kappa &amp; \cosh\kappa
\end{pmatrix}.
\]</span></p>
<p>Notice the differences from a rotation matrix:</p>
<ol type="1">
<li>Hyperbolic instead of trignometric functions</li>
<li>No sign difference between the off digaonal elements.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>Show that <span class="math display">\[
\begin{align}
\tanh 2\kappa = \frac{\delta}{\epsilon},\qquad \Omega = \sqrt{\epsilon^2-\delta^2\nonumber}\\
h = \Omega\left[b^\dagger_1b^{\vphantom{\dagger}}_1+b^\dagger_2b^{\vphantom{\dagger}}_2\right] + \Omega - \epsilon.
\end{align}
\]</span></p>
<p>The form of <span class="math inline">\(\Omega\)</span> is most easily understood by noting that the transformation preserves the determinant (<span class="math inline">\(\det\Lambda=1\)</span>).</p>
<ul>
<li><p>What happens if <span class="math inline">\(\delta&gt;\epsilon\)</span>?</p></li>
<li><p>What changes if <span class="math inline">\(\begin{pmatrix}
\epsilon &amp; \delta \\
\delta &amp; \epsilon
\end{pmatrix}\longrightarrow \begin{pmatrix}
\epsilon_1 &amp; \delta \\
\delta &amp; \epsilon_2
\end{pmatrix}\)</span>?</p></li>
</ul>
</div>
</div>
<p>Applying the same logic to our Hamiltonian <strong>?@eq-HY</strong> gives</p>
<p><span class="math display">\[
b^{\vphantom{\dagger}}_\mathbf{p}=a^{\vphantom{\dagger}}_\mathbf{p}\cosh\kappa_\mathbf{p}+a^\dagger_{-\mathbf{p}}\sinh\kappa_\mathbf{p}\nonumber\\
\qquad \tanh2\kappa_\mathbf{p}=\frac{n_0 U_0}{\tilde\epsilon(\mathbf{p})+n_0 U_0},
\]</span></p>
<p>(make sure you understand where the <span class="math inline">\(1/2\)</span> went!) and</p>
<p><span class="math display">\[
H=E_0+\sum_{\mathbf{p}\neq 0}\omega(\mathbf{p})b^\dagger_\mathbf{p}
b^{\vphantom{\dagger}}_\mathbf{p}.
\]</span></p>
<p>Here <span class="math inline">\(\omega(\mathbf{p})\)</span> is the Bogoliubov dispersion relation</p>
<p><span class="math display">\[
\omega(\mathbf{p}) = \sqrt{\tilde\epsilon(\mathbf{p})\left(\tilde\epsilon(\mathbf{p})+2U_0n_0\right)},
\]</span></p>
<p>and the ground state energy is</p>
<p><span class="math display">\[
E_0=\frac{1}{2}nU_0  N+\sum_{\mathbf{p}\neq 0}\frac{1}{2}\left[\omega(\mathbf{p})-\tilde\epsilon(\mathbf{p})-n_0U_0\right].
\]</span></p>
<p>Somewhat annoyingly, this integral is divergent in the ultraviolet. However, this is actually nothing to do with the many body physics of the problem, but is rather related to the need to regularize a <span class="math inline">\(\delta\)</span>-function potential in three dimensions (see <a href="../problem-sets/problem-set-2.html#perturbation-theory-for-the-bose-gas">Problem Set 2</a>. The cure is described in the <a href="#appendix">Appendix</a>, but it isn’t too important in what follows.</p>
</section>
<section id="the-ground-state" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="the-ground-state"><span class="header-section-number">2.3</span> The Ground State</h3>
<p>So far, our ground state is just defined by the condition that it is a vacuum of Bogoliubov excitations</p>
<p><span class="math display">\[
b^{\vphantom{\dagger}}_\mathbf{k}\lvert{0}\rangle=\left(\cosh\kappa_\mathbf{k}a^{\vphantom{\dagger}}_\mathbf{k}+\sinh\kappa_\mathbf{k}a^\dagger_{-\mathbf{k}}\right)\lvert{0}\rangle=0.
\]</span></p>
<p>But what does it <em>look</em> like? A state (unnormalized) that satisfies the above equation is</p>
<p><span id="eq-bog-wavefn"><span class="math display">\[
\lvert{0}\rangle=\prod_{\mathbf{k}\neq 0} \exp\left(-\frac{1}{2}\tanh\kappa_\mathbf{k}a^\dagger_{\mathbf{k}}a^\dagger_{-\mathbf{k}}\right)\lvert{\Psi_\text{GP}}\rangle
\tag{9}\]</span></span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>Show this. If you’ve seen coherent states before, remember that the state <span class="math inline">\(e^{\alpha a^\dagger}\lvert{\text{VAC}}\rangle\)</span> is an eigenstate of <span class="math inline">\(a^{\vphantom{\dagger}}\)</span> with eigenvalue <span class="math inline">\(\alpha\)</span>.</p>
</div>
</div>
<p>The form <a href="#eq-bog-wavefn" class="quarto-xref">Equation&nbsp;9</a> shows explicitly that the state consists of a superposition of pairs excited out of the <span class="math inline">\(\mathbf{k}=0\)</span> condensate. As we’ve discussed, we don’t actually keep track of the loss of particles from the condensate in the Bogoliubov approximation, on the assumption that it is small.</p>
<p>We can get some feeling for the properties of the ground state by considering the density fluctuations. Recall that the Fourier components of the density operator are</p>
<p><span class="math display">\[
\rho_\mathbf{q}= \sum_\mathbf{k}a^\dagger_{\mathbf{k}-\mathbf{q}}a^{\vphantom{\dagger}}_\mathbf{k}.
\]</span></p>
<p>On the basis of the logic that we’ve been following so far, the most important terms will be those where one of <span class="math inline">\(a^\dagger_{\mathbf{k}-\mathbf{q}}\)</span> or <span class="math inline">\(a^{\vphantom{\dagger}}_\mathbf{k}\)</span> acts on the condensate. Thus</p>
<p><span class="math display">\[
\rho_\mathbf{q}\sim \sqrt{N}\left(a^\dagger_{-\mathbf{q}} + a^{\vphantom{\dagger}}_{\mathbf{q}}\right) = \sqrt{N}e^{-\kappa_\mathbf{q}} \left(b^\dagger_{-\mathbf{q}} + b^{\vphantom{\dagger}}_{\mathbf{q}}\right),
\]</span></p>
<p>where</p>
<p><span class="math display">\[
e^{-\kappa_\mathbf{q}} = \sqrt{\frac{\tilde\epsilon(\mathbf{q})}{\omega(\mathbf{q})}}.
\]</span></p>
<p>The density fluctuations in the ground state are then</p>
<p><span class="math display">\[
\langle{0}\rvert \rho_{-\mathbf{q}}\rho_{\mathbf{q}} \lvert 0 \rangle = N\frac{\tilde\epsilon(\mathbf{q})}{\omega(\mathbf{q})}\xrightarrow{\mathbf{q}\to 0} \frac{N\lvert{\mathbf{q}}\rvert}{2mc}.
\]</span></p>
<p>On the right hand side we have used the low momentum form of the Bogoliubov dispersion</p>
<p><span class="math display">\[
\omega(\mathbf{q})\xrightarrow{\mathbf{q}\to 0} c\lvert{\mathbf{q}}\rvert
\]</span></p>
<p>where <span class="math inline">\(c = \sqrt{\frac{n_0U_0}{m}}\)</span> is the speed of sound. We see that the density fluctuations vanish as the wavevector goes to zero. This is to be contrasted with the result that we would find in the Gross–Pitaevskii ground state (or ground state of the ideal gas)</p>
<p><span class="math display">\[
\langle{0}\rvert \rho_{-\mathbf{q}}\rho_{\mathbf{q}} \lvert 0 \rangle = N.
\]</span></p>
<p>corresponding to uncorrelated, Poissonian fluctuations of number inside any volume of the gas. If we were to take a snapshot of the particles at any instant in the interacting gas, we would see a picture similar to the image of the Laughlin state in <a href="[ref []{.quarto-shortcode__-param data-is-shortcode=&quot;1&quot; data-value=&quot;quantum-hall-effect&quot; data-raw=&quot;&quot;quantum-hall-effect&quot;&quot;} ]{.quarto-shortcode__ data-is-shortcode=&quot;1&quot; data-raw=&quot;{{< ref &quot;quantum-hall-effect&quot; >}}&quot;}">Lecture 2</a>.</p>
<p>The other qualitatively new feature of the Bogoliubov ground state is that the zero momentum state is <em>depleted</em>. We find the momentum distribution by first writing the number operator <span class="math inline">\(N_\mathbf{p}=a^\dagger_{\mathbf{p}}a^{\vphantom{\dagger}}_{\mathbf{p}}\)</span> in terms of the Bogoliubov quasiparticles</p>
<p><span class="math display">\[
    a^\dagger_{\mathbf{p}}a^{\vphantom{\dagger}}_{\mathbf{p}}=(b^\dagger_\mathbf{p}\cosh\kappa_{\mathbf{p}}-b^{\vphantom{\dagger}}_{-\mathbf{p}}\sinh\kappa_{\mathbf{p}})(b^{\vphantom{\dagger}}_\mathbf{p}\cosh\kappa_{\mathbf{p}}-b^\dagger_{-\mathbf{p}}\sinh\kappa_{\mathbf{p}}),
\]</span></p>
<p>and then finding the average</p>
<p><span class="math display">\[
\langle N_\mathbf{p}\rangle=\langle a^\dagger_{\mathbf{p}}a^{\vphantom{\dagger}}_{\mathbf{p}}\rangle = \sinh^2\kappa_{p}\xrightarrow{ \lvert{\mathbf{p}}\rvert\ll \xi^{-1}}\frac{mc_s}{2\lvert{\mathbf{p}}\rvert}.
\]</span></p>
<p>The radial density distribution <span class="math inline">\(4\pi p^2 N_\mathbf{p}\)</span> is peaked around <span class="math inline">\(\xi^{-1}\)</span>. Summing over <span class="math inline">\(\mathbf{p}\)</span> gives the fraction of atoms not in the condensate</p>
<p><span class="math display">\[
\frac{1}{N}\sum_{\mathbf{p}\neq 0} \langle N_\mathbf{p}\rangle=\frac{8}{3\sqrt{\pi}}\sqrt{n a^3},
\]</span></p>
<p>where we used the Born approximation for the scattering length <span class="math inline">\(a=\frac{mU_0}{4\pi}\)</span>. Excluding the value <span class="math inline">\(\mathbf{p}=0\)</span> has no effect, because of the vanishing phase space at small momentum in three dimensions.</p>
<p>Under typical experimental conditions in experiments on ultracold atoms the depletion does not much exceed <span class="math inline">\(0.01\)</span>, which justifies the use of the GP approximation. Liquid He<span class="math inline">\(^{4}\)</span>, the first superfluid to be discovered, can be described as an interacting Bose condensate, but the depletion is much larger (the <em>condensate fraction</em> – the fraction of atoms in the condensate – is around 10%). The Bogoliubov approximation does not provide a quantiatively accurate description in this case.</p>
<p>In the previous lecture we met another situation where the depletion can be increased. Applying a lattice effectively reduces the kinetic energy relative to the interaction, and leads eventually to a <strong>quantum phase transition</strong> out of the superfluid state.</p>
</section>
</section>
<section id="appendix" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="appendix"><span class="header-section-number">3</span> Appendix</h2>
<section id="regularizing-the-ground-state-energy" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="regularizing-the-ground-state-energy"><span class="header-section-number">3.1</span> Regularizing the ground state energy</h3>
<p>To find the ground state energy in the Bogoliubov theory we have to compute the sum</p>
<p><span id="eq-bog-sum"><span class="math display">\[
\begin{equation}
\sum_{\mathbf{p}\neq 0}\frac{1}{2}\left[\omega(\mathbf{p})-\frac{\mathbf{p}^2}{2m}-n_0U_0\right].
\end{equation}
\tag{10}\]</span></span></p>
<p>After turning it into an integral in the usual way, we have</p>
<p><span class="math display">\[
\frac{V}{4\pi^2 m}\left[\overbrace{\int_0^\Lambda p^2 \sqrt{p^2\left(p^2+\frac{2}{\xi^2}\right)}dp}^{\equiv I(\Lambda)} - \int_0^\Lambda \left(p^4 + \frac{p^2}{\xi^2}\right) dp \right]
\]</span></p>
<p>where we have introduced an upper cutoff <span class="math inline">\(\Lambda\)</span> to see what happens as it increases to infinity. The first integral comes from the <span class="math inline">\(\omega(\mathbf{p})\)</span> in the summand. <span class="math inline">\(\xi\equiv \frac{1}{\sqrt{2m n U_0}}\)</span> is the healing length as before. Introducing the substitution <span class="math inline">\(u=p^2\)</span> gives</p>
<p><span id="eq-int-eval"><span class="math display">\[
\begin{align}
I(\Lambda) &amp;= \frac{1}{2}\int^{\Lambda^2}_0 u\sqrt{u+\frac{2}{\xi^2}} du \nonumber \\
&amp;= \left[\frac{1}{5}\left(u+\frac{2}{\xi^2}\right)^{5/2}-\frac{2}{3\xi^2} \left(u+\frac{2}{\xi^2}\right)^{3/2}\right]^{\Lambda^2}_0\nonumber \\
&amp;= \frac{\Lambda^5}{5} + \frac{\Lambda^3}{3\xi^2} -\frac{\Lambda}{2\xi^4}+\cdots.
\end{align}
\tag{11}\]</span></span> In the expansion we have retained only the terms with positive powers of <span class="math inline">\(\Lambda\)</span>. By comparing with the definition of <span class="math inline">\(I(\Lambda)\)</span>, we can see that these terms arise from the first three terms in the large <span class="math inline">\(p\)</span> expansion of the integrand</p>
<p><span id="eq-exp-integrand"><span class="math display">\[
\begin{equation}
p^2 \sqrt{p^2\left(p^2+\frac{2}{\xi^2}\right)} = p^4 + \frac{p^2}{\xi^2} - \frac{1}{2\xi^2}.
\end{equation}
\tag{12}\]</span></span></p>
<p>In the original sum <a href="#eq-bog-sum" class="quarto-xref">Equation&nbsp;10</a> the contributions of the first two terms in <a href="#eq-exp-integrand" class="quarto-xref">Equation&nbsp;12</a> are cancelled by subtracting <span class="math inline">\(\frac{1}{2}\left[\frac{\mathbf{p}^2}{2m}+n_0U_0\right]\)</span>. This still leaves us with a divergence <span class="math inline">\(\propto \Lambda\)</span> arising from last term of <a href="#eq-exp-integrand" class="quarto-xref">Equation&nbsp;12</a>. On the other hand, the sum</p>
<p><span class="math display">\[
E_\text{reg}\equiv\sum_{\mathbf{p}\neq 0}\frac{1}
{2}\left[\omega(\mathbf{p})-\tilde\epsilon(\mathbf{p})-n_0U_0+ \frac{(n_0U_0)^2}{2\tilde\epsilon(\mathbf{p})}\right]
\]</span></p>
<p><em>is</em> finite as <span class="math inline">\(\Lambda\to \infty\)</span>, because all positive powers of <span class="math inline">\(\Lambda\)</span> cancelled. The value is then given by the lower limit of the expression in <a href="#eq-int-eval" class="quarto-xref">Equation&nbsp;11</a>.</p>
<p><span class="math display">\[
E_\text{reg} = \frac{V}{m\pi^2}\frac{16}{15}(mnU_0)^{5/2}
\]</span></p>
<p>OK, but so what? That isn’t what we wanted. But notice that the regularized energy can be used to write the total energy as</p>
<p><span class="math display">\[
E_0=\frac{1}{2}nU_0  N\left[1-\frac{1}{V}\sum_\mathbf{p}\frac{U_0}{2\tilde\epsilon(\mathbf{p})}\right]+E_\text{reg}.
\]</span></p>
<p>In this form, the term we have added and subtracted can be identified as the contribution to the ground state energy in second order perturbation theory. This is divergent at large momentum for a delta function interaction, but this divergence goes away when we consider a finite range potential (we won’t show this, but it’s not too hard). Assuming that this contribution is finite because the interaction potential has a small (relative to <span class="math inline">\(\xi\)</span>) but finite range, we can then write</p>
<p><span class="math display">\[
E_0=\frac{1}{2}nN\frac{4\pi}{m}\left(a_0+a_1\right)+\frac{1}{2}n_0N\frac{4\pi}{m}a_0\frac
{128}{15\sqrt{\pi}}\left(n a_0^3\right)^{1/2},
\]</span></p>
<p>where</p>
<p><span class="math display">\[
a_0=(m/4\pi)U_0,\qquad a_1=-(m/4\pi)\frac{U_0^2}{V}\sum_\mathbf{p}\frac{1}{2\tilde\epsilon
(\mathbf{p})}.
\]</span></p>
<p>are the first two terms in the Born approximation for the scattering length <span class="math inline">\(a=a_0+a_1+\cdots\)</span>. This strongly suggests that these two terms can really be expressed only in erms of the true scattering length. Notice also that the second term has a weird <span class="math inline">\(U_0^{5/2}\)</span> dependence on the interaction strength, which is presumably connected to perturbation theory breaking down at the third order (see <a href="../problem-sets/problem-set-2.html#perturbation-theory-for-the-bose-gas">Problem Set 2</a>).</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../notes/lattice-models.html" class="pagination-link" aria-label="Lattice Models">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Lattice Models</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../notes/fermi-gas.html" class="pagination-link" aria-label="Fermi Gas">
        <span class="nav-page-text">Fermi Gas</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>