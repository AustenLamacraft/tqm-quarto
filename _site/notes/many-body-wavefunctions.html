<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Many Body Wavefunctions – Theories of Quantum Matter</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../notes/quantum-hall-effect.html" rel="next">
<link href="../notes/intro.html" rel="prev">
<link href="../favicon-32x32.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-5b4ad623e5705c0698d39aec6f10cf02.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../notes/intro.html">Notes</a></li><li class="breadcrumb-item"><a href="../notes/many-body-wavefunctions.html">Many Body Wavefunctions</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      </a>
      <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TQM Lectures 2025</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Notes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/many-body-wavefunctions.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Many Body Wavefunctions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/quantum-hall-effect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quantum Hall Effect</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/elastic-chain.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Elastic Chain</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/spin-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spin Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/second-quantization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A is for Annihilation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/more-second-quantization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">B is for Bunching</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/lattice-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lattice Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/bose-gas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bose Gas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/fermi-gas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fermi Gas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/superconductivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Superconductivity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/response-and-correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Response and Correlation</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Slides</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/many-body-wavefunctions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Many Body Wavefunctions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/quantum-hall-effect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quantum Hall Effect</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/elastic-chain.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Elastic Chain</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/spin-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spin Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/second-quantization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A is for Annihilation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/more-second-quantization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">B is for Bunching</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/lattice-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lattice Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/bose-gas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bose Gas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/fermi-gas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fermi Gas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/superconductivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Superconductivity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/response-and-correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Response and Correlation</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Problem Sets</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../problem-sets/problem-set-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Problem Set 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../problem-sets/problem-set-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Problem Set 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../problem-sets/problem-set-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Problem Set 3</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../past-papers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Past Papers</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#bosons-and-fermions" id="toc-bosons-and-fermions" class="nav-link active" data-scroll-target="#bosons-and-fermions"><span class="header-section-number">1</span> Bosons and Fermions</a>
  <ul class="collapse">
  <li><a href="#two-particles" id="toc-two-particles" class="nav-link" data-scroll-target="#two-particles"><span class="header-section-number">1.1</span> Two Particles</a></li>
  <li><a href="#product-states" id="toc-product-states" class="nav-link" data-scroll-target="#product-states"><span class="header-section-number">1.2</span> Product States</a></li>
  </ul></li>
  <li><a href="#the-1d-fermi-gas" id="toc-the-1d-fermi-gas" class="nav-link" data-scroll-target="#the-1d-fermi-gas"><span class="header-section-number">2</span> The 1D Fermi Gas</a>
  <ul class="collapse">
  <li><a href="#ground-state" id="toc-ground-state" class="nav-link" data-scroll-target="#ground-state"><span class="header-section-number">2.1</span> Ground State</a></li>
  <li><a href="#density-density-matrix-pair-distribution" id="toc-density-density-matrix-pair-distribution" class="nav-link" data-scroll-target="#density-density-matrix-pair-distribution"><span class="header-section-number">2.2</span> Density; Density Matrix; Pair Distribution</a></li>
  <li><a href="#impenetrable-bose-gas" id="toc-impenetrable-bose-gas" class="nav-link" data-scroll-target="#impenetrable-bose-gas"><span class="header-section-number">2.3</span> Impenetrable Bose Gas</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="many-body-wavefunctions.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../notes/intro.html">Notes</a></li><li class="breadcrumb-item"><a href="../notes/many-body-wavefunctions.html">Many Body Wavefunctions</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Many Body Wavefunctions</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="hidden">
<!-- See https://stackoverflow.com/questions/76398554/how-to-define-latex-macros-globally-for-a-quarto-book -->
<!-- 
Can't get these to work with tex output at the moment because they end up after \begin{document}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\E}{\mathbb{E}} 
-->
</div>
<p>We begin our study of many body quantum mechanics by examining a number of systems where eigenstates and eigenvalues may be found explicitly for any number of particles. Be warned that these situations are <strong>highly atypical</strong> – but are nevertheless very informative.</p>
<p>Reading: <span class="citation" data-cites="baym2018lectures">(<a href="#ref-baym2018lectures" role="doc-biblioref">Baym 2018</a>)</span>.</p>
<hr>
<section id="bosons-and-fermions" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="bosons-and-fermions"><span class="header-section-number">1</span> Bosons and Fermions</h2>
<p>An <span class="math inline">\(N\)</span> particle quantum system is described by a wavefunction of <span class="math inline">\(N\)</span> arguments <span class="math inline">\(\Psi(\mathbf{r}_1,\ldots, \mathbf{r}_N)\)</span>. The starting point of many body quantum mechanics is that:</p>
<div class="callout callout-style-simple callout-warning no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Systems of indistinguishable particles are described by <strong>totally symmetric</strong> or <strong>totally antisymmetric</strong> wavefunctions.</p>
</div>
</div>
</div>
<p>Just to be clear, <em>totally symmetric</em> means the wavefunction is unchanged by exchanging any two coordinates, whereas <em>totally antisymmetric</em> means that it changes sign.</p>
<p>A good fraction of this course is devoted to exploring the ramifications of this fact. Perhaps we should therefore give a <em>very</em> quick summary of why it appears to be true.</p>
<p>The first question is: what <em>are</em> indistinguishable particles? I’ll give a theorist’s answer. Indistinguishable particles are those described by Hamiltonians that are invariant under permuting the particle’s labels. Thus the sum of single particle Hamiltonians</p>
<p><span class="math display">\[
H = \sum_{i=1}^{N} \left[-\frac{\nabla_i^{2}}{2m}+V(\mathbf{r_i})\right]
\]</span></p>
<p><em>[did you remember that <span class="math inline">\(\hbar=1\)</span>?]</em> describes indistinguishable particles while</p>
<p><span class="math display">\[
H = \sum_{i=1}^{N} \left[-\frac{\nabla_i^{2}}{2m_i}+V(\mathbf{r_i})\right]
\]</span></p>
<p>does not, on account of the masses being all different. Any time we have a symmetry operation that commutes with the Hamiltonian, the eigenstates of that symmetry are preserved by time evolution with that Hamiltonian. Thus a symmetric potential <span class="math inline">\(V(x)=V(-x)\)</span> commutes with the parity operation <span class="math inline">\(x\to -x\)</span>, so the eigenstates of this operation – the even and odd wavefunctions – are preserved by time evolution.</p>
<p>The Hamiltonian of indistinguishable particles commutes with every operator of particle exchange, defined by <span class="math display">\[
P_{ij}\Psi(\mathbf{r}_1,\ldots, \mathbf{r}_i,\ldots, \mathbf{r}_j,\ldots \mathbf{r}_N) = \Psi(\mathbf{r}_1,\ldots, \mathbf{r}_j,\ldots, \mathbf{r}_i,\ldots \mathbf{r}_N).
\]</span></p>
<p>These operators satisfy <span class="math inline">\(P_{ij}^2=\mathbb{1}\)</span>, so their eigenvalues are <span class="math inline">\(\pm 1\)</span>, corresponding to states that are either symmetric or antisymmetric under exchange. The only simultaneous eigenstates of all particle exchange operations (note that different exchanges don’t commute if they involve the same particle) are the totally symmetric and antisymmetric wavefunctions. Thus these properties are preserved by time evolution. It’s always been this way.</p>
<p>We classify particles into symmetric <strong>bosons</strong> and antisymmetric <strong>fermions</strong>, named for Bose and Fermi respectively (the whimsical terminology is Dirac’s). The distinction works equally well for composite particles, provide we ignore the internal degrees of freedom and discuss only the center of mass coordinate. <!---
 Easy for us to say. Here's Dirac again: `The solution with antisymmetrical eigenfunctions, though, is probably the correct one for gas molecules, since it is known to be the correct one for electrons in an atom, and one would expect molecules to resemble electrons more closely than light-quanta.'~\citep{dirac1926}}
 --></p>
<p>All matter in the universe is made up of fermions: electrons, quarks, etc., but you can easily convince yourself that an even number of fermions make a composite boson (e.g.&nbsp;a <span class="math inline">\(^4\)</span>He atom with two electrons, two neutrons and two protons) and an odd number make a composite fermion (<span class="math inline">\(^3\)</span>He has one fewer neutron, which in turn is made up of 3 quarks).</p>
<section id="two-particles" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="two-particles"><span class="header-section-number">1.1</span> Two Particles</h3>
<p>A pair of particles is described by a wavefunction <span class="math inline">\(\Psi(\mathbf{x},\mathbf{y})\)</span>. If we are dealing with distinguishable particles, the wavefunction of a pair of particles in states <span class="math inline">\(\lvert{\varphi_1}\rangle\)</span> and <span class="math inline">\(\lvert{\varphi_2}\rangle\)</span> would be</p>
<p><span id="eq-product-wavefunction"><span class="math display">\[
\Psi(\mathbf{r}_1,\mathbf{r}_2)=\varphi_1(\mathbf{r}_1)\varphi_2(\mathbf{r}_2).
\tag{1}\]</span></span></p>
<p>Accounting for indistinguishability, we have either</p>
<p><span id="eq-sym"><span class="math display">\[
\Psi(\mathbf{r}_1,\mathbf{r}_2)=\frac{1}{\sqrt{2}}[\varphi_1(\mathbf{r}_1)\varphi_2(\mathbf{r}_2)\pm \varphi_2(\mathbf{r}_1)\varphi_1(\mathbf{r}_2)]
\tag{2}\]</span></span></p>
<p>with the upper sign for bosons and the lower for fermions (The <span class="math inline">\(1/\sqrt{2}\)</span> yields a normalized wavefunction if <span class="math inline">\(\varphi_{1,2}(\mathbf{r})\)</span> are orthonormal.). Note in particular that when <span class="math inline">\(\varphi_1=\varphi_2\)</span> the fermion wavefunction <em>vanishes</em>. This illustrates the <strong>Pauli exclusion principle</strong>, that no two identical fermions can be in the same quantum state. There is no such restriction for bosons.</p>
<p>Classically, if you had a function <span class="math inline">\(\rho_{1}(\mathbf{r}_1)\)</span> describing the probability density of finding particle <span class="math inline">\(1\)</span> at position <span class="math inline">\(\mathbf{r}_1\)</span>, and the corresponding quantity for an independent particle <span class="math inline">\(2\)</span>, you would have no hesitation in concluding that the joint distribution is</p>
<p><span class="math display">\[
\rho_{12}(\mathbf{r}_1,\mathbf{r}_2)=\rho_1(\mathbf{r}_1)\rho_2(\mathbf{r}_2).
\label{eq:classicaljoint}
\]</span></p>
<p>This also follows from taking the square modulus of <a href="#eq-product-wavefunction" class="quarto-xref">Equation&nbsp;1</a>. The result implied by the wavefunction <a href="#eq-sym" class="quarto-xref">Equation&nbsp;2</a> is <span class="math display">\[
\begin{aligned}
\rho_{12}(\mathbf{r}_1,\mathbf{r}_2) &amp;= \frac{1}{2}\left[\rho_1(\mathbf{r}_1)\rho_2(\mathbf{r}_2)+\rho_1(\mathbf{r}_2)\rho_2(\mathbf{r}_1)\right] \\
&amp;\pm\frac{1}{2}\left[\varphi^{}_1(\mathbf{r}_1)\varphi^*_2(\mathbf{r}_1)\varphi^{}_2(\mathbf{r}_2)\varphi^*_1(\mathbf{r}_2)+\varphi^{}_1(\mathbf{r}_2)\varphi^*_2(\mathbf{r}_2)\varphi^{}_2(\mathbf{r}_1)\varphi^*_1(\mathbf{r}_1)\right].
\end{aligned}
\]</span></p>
<p>In particular, <span class="math inline">\(\rho_{12}(\mathbf{r},\mathbf{r}) = 0\)</span> for fermions, and <span class="math inline">\(\rho_{12}(\mathbf{r},\mathbf{r}) = 2\rho_1(\mathbf{r})\rho_2(\mathbf{r})\)</span> for bosons. The first result is natural from the standpoint of the exclusion principle, while the second is perhaps more surprising. This shows that, because probabilities arise from the squares of amplitudes, identical particles in quantum mechanics are never truly independent.</p>
<p>One dramatic illustration of this deviation from our classical intuition is provided by the <a href="https://en.wikipedia.org/wiki/Hong%E2%80%93Ou%E2%80%93Mandel_effect">Hong–Ou–Mandel</a> effect in quantum optics. In simplified terms, we imagine wavepackets describing two photons (bosons) approaching a 50:50 beam splitter from either side. Because of the unitarity of scattering, the two photons end up in orthogonal states. For example, <span class="math display">\[
\begin{aligned}
\lvert{\text{Left}}\rangle\to\frac{1}{\sqrt{2}}\left(\lvert{\text{Left}}\rangle+ \lvert{\text{Right}}\rangle\right)\\\\
\lvert{\text{Right}}\rangle\to\frac{1}{\sqrt{2}}\left(\lvert{\text{Left}}\rangle- \lvert{\text{Right}}\rangle\right)
\end{aligned}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>If we start in <span class="math display">\[
\frac{1}{\sqrt{2}}[\varphi_\text{L}(\mathbf{r}_1)\varphi_\text{R}(\mathbf{r}_2)\pm \varphi_\text{R}(\mathbf{r}_1)\varphi_\text{L}(\mathbf{r}_2)]
\]</span> What state do we end up in?</p>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../assets/HOM.png" class="img-fluid figure-img"></p>
<figcaption>Four possible outcomes after the passage of two bosons through a beam splitter.</figcaption>
</figure>
</div>
</section>
<section id="product-states" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="product-states"><span class="header-section-number">1.2</span> Product States</h3>
<p>The Hamiltonian of a system of <span class="math inline">\(N\)</span> identical noninteracting particles is a sum of <span class="math inline">\(N\)</span> identical <strong>single particle</strong> Hamiltonians, that is, with each term acting on a different particle coordinate</p>
<p><span class="math display">\[
H = \sum_{i=1}^{N} \left[-\frac{\nabla_i^{2}}{2m}+V(\mathbf{r}_i)\right]
\label{quantum_statistics_SPHamiltonian}
\]</span></p>
<p>where <span class="math inline">\(m\)</span> is the particle mass, and <span class="math inline">\(V(\mathbf{r})\)</span> is a potential experienced by the particles.</p>
<p>Let’s denote the eigenstates of the single particle Hamiltonian by <span class="math inline">\(\{\varphi_\alpha(\mathbf{r})\}\)</span> , and the corresponding eigenenergies by <span class="math inline">\(\{E_\alpha\}\)</span>, where <span class="math inline">\(\alpha\)</span> is a shorthand for whatever quantum numbers are used to label the states.</p>
<p>A set of labels <span class="math inline">\(\{\alpha_{i}\}\)</span> <span class="math inline">\(i=1,2,\ldots N\)</span> tells us the state of each of the particles. Thus we can write an eigenstate of <span class="math inline">\(N\)</span> <em>distinguishable</em> particles with energy <span class="math inline">\(E=\sum_{i=1}^{N}E_{\alpha_{i}}\)</span> as</p>
<p><span id="eq-distinguishable"><span class="math display">\[
\lvert{\Psi_{\alpha_{1}\alpha_{2}\cdots \alpha_{N}}}\rangle=\varphi_{\alpha_{1}}(\mathbf{r_{1}})\varphi_{\alpha_{2}}(\mathbf{r_{2}})\cdots\varphi_{\alpha_{N}}(\mathbf{r_{N}})
\tag{3}\]</span></span></p>
<p>(We will frequently switch between the wavefunction <span class="math inline">\(\varphi(\mathbf{x})\)</span> and bra-ket notation <span class="math inline">\(\lvert{\varphi}\rangle\)</span>. In the latter notation the product wavefunction in <a href="#eq-product-wavefunction" class="quarto-xref">Equation&nbsp;1</a> is written <span class="math inline">\(\lvert{\varphi_{1}}\rangle\lvert{\varphi_{2}}\rangle\)</span>)</p>
<p>Such states are called <strong>product states</strong>. A general state will be expressed as a superposition of product states: they are special states which provide a frequently convenient basis.</p>
<p>As we’ve just discussed, however, we should really be dealing with a totally symmetric or totally antisymmetric wavefunction, depending on whether our identical particles are bosons or fermions. The generalization of the two-particle states <a href="#eq-sym" class="quarto-xref">Equation&nbsp;2</a> to many particles involves summing over all permutations of particle coordinates <span class="math inline">\(\mathbf{r}_i\)</span> with respect to the state labels <span class="math inline">\(\alpha_i\)</span>. To write these down we introduce the operators of <em>symmetrization</em> and <em>antisymmetrization</em></p>
<p><span id="eq-sym-antisym"><span class="math display">\[
\mathcal{S}=\frac{1}{N!}\sum_{\pi} P_\pi, \qquad \mathcal{A}=\frac{1}{N!}\sum_{\pi} \mathrm{sgn}(\pi)P_\pi
\tag{4}\]</span></span></p>
<p>Here’s the definition of the various quantities in <a href="#eq-sym-antisym" class="quarto-xref">Equation&nbsp;4</a>:</p>
<ul>
<li>The sums are over all <span class="math inline">\(N!\)</span> permutations <span class="math inline">\(\pi\)</span> of <span class="math inline">\(N\)</span> objects. One way to think of a permutation <span class="math inline">\(\pi\)</span> is as a one-to-one correspondence (or <a href="https://en.wikipedia.org/wiki/Bijection">bijection</a>) between the set <span class="math inline">\(\{1,2,\ldots N\}\)</span> and itself, so that 1 is mapped to <span class="math inline">\(\pi(1)\)</span>, etc..</li>
<li><span class="math inline">\(P_\pi\)</span> denotes the corresponding permutation operator <span class="math display">\[
P_\pi \Psi(\mathbf{r}_1,\mathbf{r}_2,\ldots \mathbf{r}_N) = \Psi(\mathbf{r}_{\pi(1)}, \mathbf{r}_{\pi(2)},\ldots \mathbf{r}_{\pi(N)})
\]</span></li>
<li><span class="math inline">\(\mathrm{sgn}(\pi)\)</span> is the <a href="https://en.wikipedia.org/wiki/Parity_of_a_permutation">signature</a> of the permutation, equal to <span class="math inline">\(+1\)</span> for permutations involving an even number of exchanges (transpositions), and <span class="math inline">\(-1\)</span> for an odd number. Note that although the same permutation can be accomplished with many different sets of transpositions, the number of transpositions is either always odd or always even.</li>
</ul>
<p><a href="#eq-sym-antisym" class="quarto-xref">Equation&nbsp;4</a> allows us to write the totally symmetric and totally antisymmetric versions of <a href="#eq-distinguishable" class="quarto-xref">Equation&nbsp;3</a> as <span id="eq-norm"><span class="math display">\[
\begin{aligned}
\lvert{\Psi^{S}_{\alpha_{1}\alpha_{2}\cdots\alpha_{N}}}\rangle&amp;=\sqrt{\frac{N!}{\prod_{\alpha}N_{\alpha}!}}\mathcal{S}\,\varphi_{\alpha_{1}}(\mathbf{r_{1}})\varphi_{\alpha_{2}}(\mathbf{r_{2}})\cdots\varphi_{\alpha_{N}}(\mathbf{r_{N}}) \\
&amp;=\sqrt{\frac{1}{N!\prod_{\alpha}N_{\alpha}!}}\sum_\pi\varphi_{\alpha_{1}}(\mathbf{r_{\pi(1)}})\varphi_{\alpha_{2}}(\mathbf{r_{\pi(2)}})\cdots\varphi_{\alpha_{N}}(\mathbf{r_{\pi(N)}})\\
\lvert{\Psi^{A}_{\alpha_{1}\alpha_{2}\cdots\alpha_{N}}}\rangle&amp;=\sqrt{N!}\mathcal{A}\,\varphi_{\alpha_{1}}(\mathbf{r_{1}})\varphi_{\alpha_{2}}(\mathbf{r_{2}})\cdots\varphi_{\alpha_{N}}(\mathbf{r_{N}})\\
&amp;=\sqrt{\frac{1}{N!}}\sum_\pi \mathrm{sgn}(\pi)\varphi_{\alpha_{1}}(\mathbf{r_{\pi(1)}})\varphi_{\alpha_{2}}(\mathbf{r_{\pi(2)}})\cdots\varphi_{\alpha_{N}}(\mathbf{r_{\pi(N)}}),
\end{aligned}
\tag{5}\]</span></span></p>
<p>where the <strong>occupation numbers</strong> <span class="math inline">\(\{N_{\alpha}\}\)</span> in the boson case give the number of particles in state <span class="math inline">\(\alpha\)</span>. Note that it doesn’t matter if we permute <em>coordinates</em> or state labels <span class="math inline">\(\alpha_i\)</span> in <a href="#eq-norm" class="quarto-xref">Equation&nbsp;5</a>. Thus the symmetric product state can also be written</p>
<p><span class="math display">\[
\lvert{\Psi^{S}_{\alpha_{1}\alpha_{2}\cdots\alpha_{N}}}\rangle=\sqrt{\frac{1}{N!\prod_{\alpha}N_{\alpha}!}}\sum_\pi\varphi_{\alpha_{\pi(1)}}(\mathbf{r_{1}})\varphi_{\alpha_{\pi(2)}}(\mathbf{r_2})\cdots\varphi_{\alpha_{\pi(N)}}(\mathbf{r_N}).
\]</span></p>
<p>These normalization factors yield normalized wavefunctions <em>if</em> the single particle state <span class="math inline">\(\lvert{\varphi_\alpha}\rangle\)</span> are orthonormal (as the eigenstates of the single particle Hamiltonian are). In the fermion case each <span class="math inline">\(N_{\alpha}\)</span> is either <span class="math inline">\(0\)</span> or <span class="math inline">\(1\)</span> so the prefactor simplifies. Since the order of the <span class="math inline">\(\alpha\)</span> indices is irrelevant in the boson case, and amounts only to a sign in the fermion case, states based on a given set of single particle states are more efficiently labeled by the occupation numbers. In terms of these numbers the total energy is</p>
<p><span class="math display">\[
\label{quantum_statistics_TotalEnergy}
E=\sum_{i=1}^{N}E_{\alpha_{i}}=\sum_{\alpha}N_{\alpha} E_{\alpha}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>Verify that the normalization factors in <a href="#eq-norm" class="quarto-xref">Equation&nbsp;5</a> are correct.</p>
</div>
</div>
<p>A more formal way of putting things is as follows. We first consider the space spanned by states of the form <a href="#eq-distinguishable" class="quarto-xref">Equation&nbsp;3</a>. Then we introduce the operators <span class="math inline">\(\mathcal{S}\)</span> and <span class="math inline">\(\mathcal{A}\)</span>, noting that <span class="math inline">\(\mathcal{S}^{2}=\mathcal{S}\)</span> and <span class="math inline">\(\mathcal{A}^{2}=\mathcal{A}\)</span>. In other words, there’s no point symmetrizing or antisymmetrizing more than once (we say that the operators are <strong>idempotent</strong>). Any eigenvalue of one of these operators is therefore either one or zero. The states with <span class="math inline">\(\mathcal{S}=1\)</span> are the symmetric states, and those with <span class="math inline">\(\mathcal{A}=1\)</span> are antisymmetric. You can easily convince yourself that if a state has one of <span class="math inline">\(\mathcal{S}\)</span> or <span class="math inline">\(\mathcal{A}\)</span> equal to one, the other is zero. This defines symmetric and antisymmetric subspaces, consisting of the admissible boson and fermion wavefunctions.</p>
<p>Note that the fermion wavefunction takes the form of a <strong>Slater determinant</strong> (though it appears first in {% cite dirac1926 %}).</p>
<p><span id="eq-slater"><span class="math display">\[
   \lvert{\Psi^{A}_{\alpha_{1}\alpha_{2}\cdots\alpha_{N}}}\rangle=\frac{1}{\sqrt{N!}}\begin{vmatrix}
   \varphi_{\alpha_{1}}(\mathbf{r_{1}}) &amp;   \varphi_{\alpha_{1}}(\mathbf{r_{2}}) &amp; \cdots &amp; \varphi_{\alpha_{1}}(\mathbf{r_{N}}) \\
   \varphi_{\alpha_{2}}(\mathbf{r_{1}}) &amp;  \cdots &amp; \cdots &amp; \cdots  \\
   \cdots &amp; \cdots &amp; \cdots &amp; \cdots  \\
   \varphi_{\alpha_{N}}(\mathbf{r_{1}}) &amp;  \cdots &amp; \cdots &amp; \varphi_{\alpha_{N}}(\mathbf{r_{N}})
\end{vmatrix}
\tag{6}\]</span></span></p>
<p>The vanishing of a determinant when two rows or two columns are identical means that the wavefunction is zero if two particle coordinates coincide (<span class="math inline">\(\mathbf{r}_{i}=\mathbf{r}_{j}\)</span>), or if two particles occupy the same state (<span class="math inline">\(\alpha_{i}=\alpha_{j}\)</span>).</p>
</section>
</section>
<section id="the-1d-fermi-gas" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="the-1d-fermi-gas"><span class="header-section-number">2</span> The 1D Fermi Gas</h2>
<p>Let’s consider perhaps the simplest many particle system one can think of: noninteracting particles on a ring. If the ring has circumference <span class="math inline">\(L\)</span>, the single particle eigenstates are <span class="math display">\[
    \label{quantum_statistics_spstates}
    \varphi_{n}(x)=\frac{1}{\sqrt{L}}\exp\left(ik_n x\right),
\]</span></p>
<p>with <span class="math inline">\(k_n=\frac{2\pi n}{L}\)</span>, <span class="math inline">\(n\in\mathbb{Z}\)</span>. The corresponding energies are <span class="math inline">\(E_{n}=\frac{k_n^2}{2m}\)</span>.</p>
<section id="ground-state" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="ground-state"><span class="header-section-number">2.1</span> Ground State</h3>
<p>Let’s find the <span class="math inline">\(N\)</span> particle ground state. For bosons every particle is in the state <span class="math inline">\(\lvert{\varphi_{0}}\rangle\)</span> with zero energy: <span class="math inline">\(N_{0}=N\)</span>. Thus</p>
<p><span class="math display">\[
    \Psi^{S}_0(x_{1},x_{2},\ldots x_{N})=\frac{1}{L^{N/2}}
\]</span></p>
<p>That was easy! The fermion case is harder.</p>
<p>Since the occupation of each level is at most one, the lowest energy is obtained by filling each level with one particle, starting at the bottom. If we have an odd number of particles, this means filling the levels with <span class="math inline">\(n=-(N-1)/2, -(N-3)/2,\ldots, -1, 0, 1 \ldots (N-1)/2\)</span> (for an even number of particles we have to decide whether to put the last particle at <span class="math inline">\(n=\pm N/2\)</span>). Introducing the complex variables</p>
<p><span class="math display">\[
z_{i}=\exp(2 \pi i x_{i}/L),
\]</span></p>
<p>the Slater determinant <a href="#eq-slater" class="quarto-xref">Equation&nbsp;6</a> becomes</p>
<p><span id="eq-1d-det"><span class="math display">\[
    \Psi^A_0(x_1,\ldots, x_N)=\begin{vmatrix}
    z_{1}^{-(N-1)/2} &amp;  z_{2}^{-(N-1)/2} &amp; \cdots &amp; z_{N}^{-(N-1)/2} \\
    z_{1}^{-(N-3)/2} &amp;  \cdots &amp; \cdots &amp; \cdots  \\
    \cdots &amp; \cdots &amp; \cdots &amp; \cdots  \\
    z_{1}^{(N-1)/2} &amp;  \cdots &amp; \cdots &amp; z_{N}^{(N-1)/2}
\end{vmatrix}.
\tag{7}\]</span></span></p>
<p>Let’s evaluate this complicated looking expression in a simple case. With three particles we have</p>
<p><span id="eq-3-particle"><span class="math display">\[
\begin{aligned}
    \Psi^A_0(x_1,x_2,x_3)&amp;=\begin{vmatrix}
        z_{1}^{-1} &amp; z_{2}^{-1} &amp; z_{3}^{-1} \\
        1 &amp; 1 &amp; 1 \\
        z_{1} &amp; z_{2} &amp; z_{3}
    \end{vmatrix} = \frac{z_{1}}{z_{2}}-\frac{z_{2}}{z_{1}}+\frac{z_{3}}{z_{1}}-\frac{z_{1}}{z_{3}}+\frac{z_{2}}{z_{3}}-\frac{z_{3}}{z_{2}}\nonumber\\
    &amp;=\left(\sqrt{\frac{z_{3}}{z_{1}}}-\sqrt{\frac{z_{1}}{z_{3}}}\right)\left(\sqrt{\frac{z_{1}}{z_{2}}}-\sqrt{\frac{z_{2}}{z_{1}}}\right)\left(\sqrt{\frac{z_{2}}{z_{3}}}-\sqrt{\frac{z_{3}}{z_{2}}}\right)  \nonumber\\
    &amp;\propto \sin\left(\frac{ \pi[x_{1}-x_{2}]}{L}\right)\sin\left(\frac{ \pi[x_{3}-x_{1}]}{L}\right)\sin\left(\frac{ \pi[x_{2}-x_{3}]}{L}\right)
\end{aligned}
\tag{8}\]</span></span></p>
<p>The vanishing of the wavefunction when <span class="math inline">\(x_{i}=x_{j}\)</span> is consistent with the Pauli principle. You should check that additionally it is periodic and totally antisymmetric.</p>
<p><a href="#eq-3-particle" class="quarto-xref">Equation&nbsp;8</a> generalizes for any (odd) <span class="math inline">\(N\)</span> so that the ground state Slater determinant <a href="#eq-1d-det" class="quarto-xref">Equation&nbsp;7</a> is proportional to</p>
<p><span id="eq-1d-fermi-gs"><span class="math display">\[
\Psi^A_0(x_1,\ldots, x_N)\propto\prod_{i&lt;j}^{N} \sin\left(\frac{\pi[x_{i}-x_{j}]}{L}\right).
\tag{9}\]</span></span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>Show this using the <strong>Vandermonde determinant</strong> <span class="math display">\[
\begin{vmatrix}
1 &amp; 1 &amp; \cdots &amp; 1 \\
z_{1} &amp;  z_{2} &amp; \cdots &amp; \cdots  \\
z_{1}^{2} &amp; z_{2}^{2} &amp; \cdots &amp; \cdots  \\
z_{1}^{N-1} &amp;  z_{2}^{N-1} &amp; \cdots &amp; z_{N}^{N-1}
\end{vmatrix}=\prod_{i&lt;j}^{N}(z_{j}-z_{i})
\]</span> which can be proved in a variety of ways. Proving directly that <a href="#eq-1d-fermi-gs" class="quarto-xref">Equation&nbsp;9</a> is an eigenstate of the Hamiltonian is not easy, but can be accomplished using the identity</p>
<p><span class="math display">\[
\cot(x-y)\cot(y-z)+\cot(y-z)\cot(z-x)+\cot(z-x)\cot(x-y)=1. \nonumber
\]</span></p>
<p>Check carefully that <a href="#eq-1d-fermi-gs" class="quarto-xref">Equation&nbsp;9</a> is periodic and totally antisymmetric.</p>
</div>
</div>
<p>Let’s take the opportunity to introduce some terminology. The wavevector of the last fermion added is called the <strong>Fermi wavevector</strong> and denoted <span class="math inline">\(k_\text{F}\)</span>. In this case <span class="math inline">\(k_\text{F}=\frac{(N-1)\pi}{L}\)</span>. Its energy <span class="math inline">\(E_{F}=\frac{k_\text{F}^{2}}{2m}\)</span> is the <strong>Fermi energy</strong>.</p>
</section>
<section id="density-density-matrix-pair-distribution" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="density-density-matrix-pair-distribution"><span class="header-section-number">2.2</span> Density; Density Matrix; Pair Distribution</h3>
<p>Having a many particle wave function is one thing, but what to <em>do</em> with it? Bear in mind that <a href="#eq-1d-fermi-gs" class="quarto-xref">Equation&nbsp;9</a> is just about the simplest fermion state you can imagine, but it’s not immediately clear what it is telling us.</p>
<p><span class="math inline">\(\vert\Psi(x_1,\ldots,x_N)\rvert^2\)</span> is the probability distribution of the positions of the particles. If we were able to take a photograph of the positions of the particles at an instant in time, this would correspond to taking a sample from the probability distribution. In terms of the complex variables <span class="math inline">\(z_j\)</span>, it would look something like this:</p>
<div id="fig-1d-dist" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-1d-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-1d-dist" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-fermion" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-fermion-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../assets/1d_fermions.png" class="img-fluid figure-img" data-ref-parent="fig-1d-dist">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-fermion-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) A sample from the probability distribution <span class="math inline">\(\lvert\Psi^A_0(z_1,\ldots,z_N)\rvert^2\)</span> for 50 particles.
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-1d-dist" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-poisson" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-poisson-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../assets/poisson_phases.png" class="img-fluid figure-img" data-ref-parent="fig-1d-dist">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-poisson-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Uniformly distributed points on the circle described by <span class="math inline">\(\vert\Psi^{S}_0(x_{1},x_{2},\ldots x_{N})\rvert^2\)</span>. The particle positions are uncorrelated.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-1d-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Distribution of particle positions for noninteracting fermion and boson ground states.
</figcaption>
</figure>
</div>
<p>Since <span class="math inline">\(\lvert\Psi(x_1,\ldots,x_N)\rvert^2\)</span> is the probability distribution of the positions of the particles, we can use it to find the marginal probability distributions for any subset of the particles. Of course, since the particles are identical, it doesn’t matter which ones we choose, just the number.</p>
<p>The one particle distribution is related to the average density of particles, given by <span id="eq-average-density"><span class="math display">\[
\rho_1(x_1) = N \int dx_2\ldots dx_N \,\lvert\Psi(x_1,x_2,\ldots,x_N)\rvert^2.
\tag{10}\]</span></span> Note that although I use the symbol <span class="math inline">\(\rho\)</span>, density is always going to be <em>number</em> density (not the mass density).</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>Can you explain why this is the density? Think about the simpler case of two particles, with discrete locations. Why is the expected number of particles at position <span class="math inline">\(x\)</span> <span class="math display">\[
N_x = \sum_y \left[P(x,y) + P(y,x)\right]?
\]</span></p>
<p>What if we have more particles?</p>
</div>
</div>
<p>Normalization of the wavefunction then implies <span class="math display">\[
\int dx\, \rho_1(x) = N.
\]</span> In a translationally invariant system like the fermion gas on a ring we expect the average density to be constant.</p>
<p>We can regard <a href="#eq-average-density" class="quarto-xref">Equation&nbsp;10</a> as an expectation of a density operator <span id="eq-density-op"><span class="math display">\[
\rho(x) = \sum_j \delta(x-x_j),
\tag{11}\]</span></span> so that <span class="math inline">\(\rho_1(x) = \langle{\Psi}\rvert \rho(x) \lvert \Psi \rangle\)</span>.</p>
<p>The <strong>single particle density matrix</strong> is a generalization of the expectation of the density, and is defined as (we’ll see shortly why this is a useful quantity) <span id="eq-spdm"><span class="math display">\[
g(x,y) \equiv N\int dx_2\ldots dx_N \,\Psi^{}(x,x_2,\ldots,x_N)\Psi^{*}(y,x_2,\ldots,x_N).
\tag{12}\]</span></span> Note that <span class="math inline">\(g(x,x) = \rho_1(x)\)</span>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>Show that the average number of particles in a single particle state <span class="math inline">\(\lvert{\psi}\rangle\)</span> is <span id="eq-nbar"><span class="math display">\[
\bar N_\psi = \int dx dy\, \psi^*(x)g(x,y)\psi(y).
\tag{13}\]</span></span></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>Starting from the Slater determinant <a href="#eq-1d-det" class="quarto-xref">Equation&nbsp;7</a> (i.e.&nbsp;<em>not</em> from the explicit form <a href="#eq-1d-fermi-gs" class="quarto-xref">Equation&nbsp;9</a>), show that <span class="math inline">\(g(x,y)\)</span> for the ground state of the Fermi gas is <span class="math display">\[
g(x,y) = \frac{1}{L}\sum_{|k|&lt;k_\text{F}} e^{ik(x-y)} = \int_{k_\text{F}}^{k_\text{F}} \frac{dk}{2\pi} e^{ik(x-y)} = n \frac{\sin \left[k_\text{F}(x-y)\right]}{k_\text{F}(x-y)}
\]</span> where <span class="math inline">\(n \equiv \frac{k_\text{F}}{\pi}\)</span> is the average density.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>Find the average number of particles in a momentum state <span class="math inline">\(\lvert{k}\rangle\)</span> using <a href="#eq-nbar" class="quarto-xref">Equation&nbsp;13</a> <span id="eq-nk"><span class="math display">\[
\bar N_k = \begin{cases}
1 &amp; |k|\leq k_\text{F} \\
0 &amp; |k|&gt;k_\text{F}
\end{cases}.
\tag{14}\]</span></span> Note that in a translationally invariant system <span class="math inline">\(g(x,y)=g(x-y)\)</span>, and is the Fourier transform of <span class="math inline">\(\bar N_k\)</span>.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>To understand the origin of the name <em>single particle density matrix</em>, recall that the density matrix <span class="math inline">\(\varrho\)</span> describes a <strong>mixed state</strong> of a quantum system, and is the appropriate description when the quantum state is not known. <span class="math inline">\(\varrho\)</span> is a positive definite hermitian operator satisfying <span class="math inline">\(\mathrm{tr}\varrho =1\)</span>. Its spectral resolution <span class="math display">\[
\varrho = \sum_\alpha p_\alpha \lvert{\varphi_\alpha}\rangle\langle{\varphi_\alpha}\rvert,
\]</span> can be thought of as a statistical mixture of different quantum states <span class="math inline">\(\lvert{\varphi_\alpha}\rangle\)</span> with probabilities <span class="math inline">\(p_\alpha\)</span>.</p>
<p>One natural way in which density matrices arise from pure states is as follows. The Hilbert space of a composite system consists of a tensor product of two or more components <span class="math inline">\(\mathcal{H}_{AB} = \mathcal{H}_A \otimes \mathcal{H}_B\)</span>. Starting from the density matrix corresponding to a pure state, we can obtain a density matrix for the component <span class="math inline">\(A\)</span> alone by ‘tracing out’ the <span class="math inline">\(B\)</span> subsystem. <span class="math display">\[
\varrho_A = \mathrm{tr}_B \lvert{\Psi}\rangle\langle{\Psi}\rvert,\quad \lvert{\Psi}\rangle\in \mathcal{H}_{AB}.
\]</span> The probability for system <span class="math inline">\(A\)</span> to be in state <span class="math inline">\(\lvert{\psi}\rangle\in \mathcal{H}_A\)</span> is <span class="math display">\[
P_\psi = \langle{\psi}\rvert\varrho\lvert{\psi}\rangle.
\]</span> Thus you can think of the single particle density matrix <a href="#eq-spdm" class="quarto-xref">Equation&nbsp;12</a> as arising from tracing out <span class="math inline">\(N-1\)</span> particles from an <span class="math inline">\(N\)</span>-particle system.</p>
<p>We can also consider marginal probability distribution of a pair of particles, and define the <strong>pair distribution function</strong> <span class="math display">\[
\rho_2(x_1,x_2) = N(N-1) \int dx_3\ldots dx_N \,\left|\Psi(x_1,x_2,\ldots,x_N)\right|^2.
\]</span> The prefactor is to account for all pairs of particles.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>Starting from the Slater determinant <a href="#eq-1d-det" class="quarto-xref">Equation&nbsp;7</a>, show that <span class="math display">\[
\rho_2(x_1,x_2) = n^2\left[1 - \left(\frac{\sin\left[k_\text{F}(x_1-x_2)\right]}{k_\text{F}(x_1-x_2)}\right)^2\right].
\]</span> This vanishes at <span class="math inline">\(x_1=x_2\)</span>, consistent with the Pauli principle.</p>
</div>
</div>
<p>A natural question: <span class="math display">\[
\rho_2(x_1,x_2) \overset{?}{=} \langle{\Psi}\rvert\rho(x_1)\rho(x_2)\lvert{\Psi}\rangle.
\]</span> <em>Almost</em>. Looking back at <a href="#eq-density-op" class="quarto-xref">Equation&nbsp;11</a>, we see that the product of two density operators will contain terms involving the same particle, which are absent from <span class="math inline">\(\rho_2(x_1,x_2)\)</span>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>Show that the correct relationship is <span class="math display">\[
\rho_2(x_1,x_2) = \langle{\Psi}\rvert\rho(x_1)\rho(x_2)\lvert{\Psi}\rangle - \rho_1(x_1)\delta(x_1-x_2).
\]</span></p>
</div>
</div>
</section>
<section id="impenetrable-bose-gas" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="impenetrable-bose-gas"><span class="header-section-number">2.3</span> Impenetrable Bose Gas</h3>
<p>There’s a bit more mileage in the 1D Fermi gas yet. Consider the following Hamiltonian <span class="math display">\[
H = -\frac{1}{2m}\sum_j \frac{\partial^2}{\partial x_j^2} + \overbrace{c\sum_{j&lt;k}\delta(x_j-x_k)}^{\equiv H_\text{int}}.
\label{many_LL}
\]</span> The second term represents an interaction between pairs of particles. Of course, this model is rather special, as (1) it’s 1D and (2) the interaction potential is a <span class="math inline">\(\delta\)</span>-function. Nevertheless, it represents a huge step up in difficulty from the noninteracting examples we’ve discussed so far. At least, it does for bosons. For fermions, the wavefunctions vanish at coincident points, and so the interaction has no effect at all!</p>
<p>For bosons, it happens that the Hamiltonian can still be solved exactly. For now, however, we’ll concern ourselves only with the limit of infinite interaction: <span class="math inline">\(c\to \infty\)</span>, sometimes called the impenetrable limit. In this case, <em>the eigenenergies coincide with those of the free fermion problem, and the eigenstates are just the modulus of the corresponding fermion eigenstate</em>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>Why?</p>
</div>
</div>
<p>Just like that, we’ve solved our first interacting many body system (and with infinite coupling, no less)!</p>
<p>Thus the ground state on the ring has the form <span class="math display">\[
\Psi_0(x_1,\ldots, x_N) = \prod_{i&lt;j}^{N} \left|\sin\left(\frac{\pi[x_{i}-x_{j}]}{L}\right)\right|.
\]</span></p>
<p>It’s not hard to see why this works. For a state to have a finite energy, the wavefunction must vanish whenever two coordinates coincide. This is because the interation energy has the expectation value <span class="math display">\[
\langle{\Psi}\rvert H_\text{int} \lvert \Psi \rangle=cN(N-1)\int dx_1\cdots dx_{N-1}\left|
\Psi(x_1,x_1,x_2,\ldots,x_N\right|^2
\]</span> But we already have a complete set of eigenstates that obey this condition, namely the free fermion Slater determinants. It remains to make them symmetric functions by taking the modulus.</p>
<p>This mapping is quite powerful, and allows us to calculate any observable of the impenetrable Bose gas in terms of free fermions <em>as long</em> as that observable is insensitive to taking the modulus of the wavefunction. Thus the average density <span class="math inline">\(\rho_1(x)\)</span> and pair distribution <span class="math inline">\(\rho_2(x_1,x_2)\)</span> of the previous section can be found in this way, but the single particle density matrix <span class="math inline">\(g(x,y)\)</span> cannot.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>Show this explicitly.</p>
</div>
</div>
<p>This means that the momentum distribution is <em>not</em> given by <a href="#eq-nk" class="quarto-xref">Equation&nbsp;14</a>. Finding <span class="math inline">\(g(x,y)\)</span> for the impenetrable Bose gas is in fact really hard. We’ll see in a later lecture how to obtain some of its important features.</p>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-baym2018lectures" class="csl-entry" role="listitem">
Baym, Gordon. 2018. <em>Lectures on Quantum Mechanics</em>. CRC Press.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../notes/intro.html" class="pagination-link" aria-label="Introduction">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Introduction</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../notes/quantum-hall-effect.html" class="pagination-link" aria-label="Quantum Hall Effect">
        <span class="nav-page-text">Quantum Hall Effect</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>