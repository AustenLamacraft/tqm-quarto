<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Response and Correlation – Theories of Quantum Matter</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../slides/many-body-wavefunctions.html" rel="next">
<link href="../notes/superconductivity.html" rel="prev">
<link href="../favicon-32x32.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-5b4ad623e5705c0698d39aec6f10cf02.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../notes/intro.html">Notes</a></li><li class="breadcrumb-item"><a href="../notes/response-and-correlation.html">Response and Correlation</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      </a>
      <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TQM Lectures 2025</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Notes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/many-body-wavefunctions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Many Body Wavefunctions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/quantum-hall-effect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quantum Hall Effect</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/elastic-chain.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Elastic Chain</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/spin-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spin Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/second-quantization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A is for Annihilation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/more-second-quantization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">B is for Bunching</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/lattice-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lattice Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/bose-gas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bose Gas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/fermi-gas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fermi Gas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/superconductivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Superconductivity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/response-and-correlation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Response and Correlation</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Slides</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/many-body-wavefunctions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Many Body Wavefunctions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/quantum-hall-effect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quantum Hall Effect</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/elastic-chain.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Elastic Chain</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/spin-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spin Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/second-quantization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A is for Annihilation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/more-second-quantization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">B is for Bunching</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/lattice-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lattice Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/bose-gas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bose Gas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/fermi-gas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fermi Gas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/superconductivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Superconductivity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/response-and-correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Response and Correlation</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Problem Sets</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../problem-sets/problem-set-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Problem Set 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../problem-sets/problem-set-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Problem Set 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../problem-sets/problem-set-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Problem Set 3</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../past-papers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Past Papers</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#probing-many-body-systems" id="toc-probing-many-body-systems" class="nav-link active" data-scroll-target="#probing-many-body-systems"><span class="header-section-number">1</span> Probing Many Body systems</a></li>
  <li><a href="#response-of-a-damped-oscillator" id="toc-response-of-a-damped-oscillator" class="nav-link" data-scroll-target="#response-of-a-damped-oscillator"><span class="header-section-number">2</span> Response of a Damped Oscillator</a>
  <ul class="collapse">
  <li><a href="#greens-function-for-the-damped-oscillator" id="toc-greens-function-for-the-damped-oscillator" class="nav-link" data-scroll-target="#greens-function-for-the-damped-oscillator"><span class="header-section-number">2.1</span> Green’s Function for the Damped Oscillator</a></li>
  <li><a href="#properties-of-the-susceptibility" id="toc-properties-of-the-susceptibility" class="nav-link" data-scroll-target="#properties-of-the-susceptibility"><span class="header-section-number">2.2</span> Properties of the Susceptibility</a></li>
  <li><a href="#mechanical-model-of-dissipation" id="toc-mechanical-model-of-dissipation" class="nav-link" data-scroll-target="#mechanical-model-of-dissipation"><span class="header-section-number">2.3</span> Mechanical Model of Dissipation</a></li>
  <li><a href="#finite-temperature-fluctuations" id="toc-finite-temperature-fluctuations" class="nav-link" data-scroll-target="#finite-temperature-fluctuations"><span class="header-section-number">2.4</span> Finite Temperature Fluctuations</a></li>
  <li><a href="#quantum-fluctuations" id="toc-quantum-fluctuations" class="nav-link" data-scroll-target="#quantum-fluctuations"><span class="header-section-number">2.5</span> Quantum Fluctuations</a></li>
  <li><a href="#golden-rule-and-dissipation" id="toc-golden-rule-and-dissipation" class="nav-link" data-scroll-target="#golden-rule-and-dissipation"><span class="header-section-number">2.6</span> Golden Rule and Dissipation</a></li>
  </ul></li>
  <li><a href="#linear-response-formal-theory" id="toc-linear-response-formal-theory" class="nav-link" data-scroll-target="#linear-response-formal-theory"><span class="header-section-number">3</span> Linear Response: Formal Theory</a>
  <ul class="collapse">
  <li><a href="#kubo-formula" id="toc-kubo-formula" class="nav-link" data-scroll-target="#kubo-formula"><span class="header-section-number">3.1</span> Kubo Formula</a></li>
  <li><a href="#fluctuation-dissipation-theorem" id="toc-fluctuation-dissipation-theorem" class="nav-link" data-scroll-target="#fluctuation-dissipation-theorem"><span class="header-section-number">3.2</span> Fluctuation Dissipation Theorem</a></li>
  <li><a href="#spectral-representation" id="toc-spectral-representation" class="nav-link" data-scroll-target="#spectral-representation"><span class="header-section-number">3.3</span> Spectral Representation</a></li>
  </ul></li>
  <li><a href="#response-of-matter" id="toc-response-of-matter" class="nav-link" data-scroll-target="#response-of-matter"><span class="header-section-number">4</span> Response of Matter</a>
  <ul class="collapse">
  <li><a href="#density-response" id="toc-density-response" class="nav-link" data-scroll-target="#density-response"><span class="header-section-number">4.1</span> Density Response</a></li>
  <li><a href="#sum-rules" id="toc-sum-rules" class="nav-link" data-scroll-target="#sum-rules"><span class="header-section-number">4.2</span> Sum rules</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="response-and-correlation.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../notes/intro.html">Notes</a></li><li class="breadcrumb-item"><a href="../notes/response-and-correlation.html">Response and Correlation</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Response and Correlation</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="hidden">
<!-- See https://stackoverflow.com/questions/76398554/how-to-define-latex-macros-globally-for-a-quarto-book -->
<!-- 
Can't get these to work with tex output at the moment because they end up after \begin{document}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\E}{\mathbb{E}} 
-->
</div>
<p>Calculating eigenstates and eigenenergies is one thing, but what do experimentalists actually measure?</p>
<hr>
<section id="probing-many-body-systems" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="probing-many-body-systems"><span class="header-section-number">1</span> Probing Many Body systems</h2>
<p>Our first encounters with quantum mechanics involve finding the <em>energies</em> of stationary states, whether of the Hydrogen atom or a box of radiation in thermal equilibrium. Finding the energy of metallic Sodium (to pick a simple metal) is important if you want to be able calculate the melting temperature, but most experiments probe properties of a state of matter that are not simply contained in thermodynamic functions of state. For example, seeing that a metal is reflective involves shining light and measuring how it is scattered.</p>
<p>When a theorist looks at an experimentalist, what they see is a machine for measuring <strong>response functions</strong>, which encode the response of a system to external perturbations. The theorist’s job is to understand what kinds of response are possible (e.g.&nbsp;metallic, insulating, superconducting), and hopefully to actually calculate response functions for a particular model. Often this is what really characterizes a state of matter: the thermodynamic differences between a metal and a superconductor are far less significant that the differing electromagnetic response.</p>
<p>In this lecture we will see how response functions are encoded in the eigenvalues and eigenstates of a many body system, and their general features. In fact, you’ve probably already met response functions in another guise: as <strong>Green’s functions</strong>.</p>
</section>
<section id="response-of-a-damped-oscillator" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="response-of-a-damped-oscillator"><span class="header-section-number">2</span> Response of a Damped Oscillator</h2>
<p>On the grounds that it’s always best to start with a single degree of freedom first, we introduce the idea of response functions for (sigh) the harmonic oscillator.</p>
<section id="greens-function-for-the-damped-oscillator" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="greens-function-for-the-damped-oscillator"><span class="header-section-number">2.1</span> Green’s Function for the Damped Oscillator</h3>
<p>Consider your old friend, the damped driven oscillator</p>
<p><span id="eq-sho"><span class="math display">\[
m\ddot y +m\omega_0^2 y + \gamma \dot y =f(t).
\tag{1}\]</span></span></p>
<p>Solving this problem, as you’ve doubtless done many times, involves finding <span class="math inline">\(y(t)\)</span> given <span class="math inline">\(f(t)\)</span>. Without going any further, what can we say about such a solution? <a href="#eq-sho" class="quarto-xref">Equation&nbsp;1</a> is linear, which means that <span class="math inline">\(y(t)\)</span> depends linearly on <span class="math inline">\(f(t)\)</span>. By the principle of superposition we can immediately write</p>
<p><span class="math display">\[
y(t) = \int \chi(t,s) f(s)\,ds.
\]</span></p>
<p><span class="math inline">\(\chi(t,s)\)</span> is our first example of a response function, Green’s function, or <strong>susceptibility</strong>. On general grounds, we can say two more things about <span class="math inline">\(\chi(t,s)\)</span>. First, that it is <strong>causal</strong>, meaning that, since effect follows cause:</p>
<p><span class="math display">\[
\chi(t,s)=0,\quad \text{for }t&lt;s.
\]</span></p>
<p>Second, since the LHS of <a href="#eq-sho" class="quarto-xref">Equation&nbsp;1</a> has no explicit time dependence, <span class="math inline">\(\chi\)</span> is really a function only of <span class="math inline">\(t-s\)</span>. We can certainly imagine situations where this is not true. Causality, however, seems pretty watertight (even if we don’t understand why).</p>
<p>We can interpret <span class="math inline">\(\chi(t)\)</span> as the solution of <a href="#eq-sho" class="quarto-xref">Equation&nbsp;1</a> to a <span class="math inline">\(\delta\)</span>-function force at <span class="math inline">\(t=0\)</span>.</p>
<p><span id="eq-chi-ode"><span class="math display">\[
m\ddot \chi +m\omega_0^2 \chi + \gamma \dot \chi =\delta(t).
\tag{2}\]</span></span></p>
<p>There are at least two ways to go about finding <span class="math inline">\(\chi(t)\)</span> in this case. The first is most direct: recall that the free motion of the oscillator can be written in terms of the complex exponential <span class="math inline">\(e^{-i\omega t}\)</span>, where <span class="math inline">\(\omega\)</span> satisfies</p>
<p><span class="math display">\[
m\omega^2+i\gamma\omega - m\omega_0^2 =0,
\]</span></p>
<p>so that</p>
<p><span class="math display">\[
\omega_{\pm} = \pm \sqrt{\omega_0^2-\frac{\gamma^2}{4m^2}}-i\frac{\gamma}{2m} \equiv \pm\omega_1-i\frac{\gamma}{2m}.
\]</span></p>
<p>Since <span class="math inline">\(\chi(t)=0\)</span> for <span class="math inline">\(t&lt;0\)</span>, we can get a <span class="math inline">\(\delta\)</span>-function in <a href="#eq-chi-ode" class="quarto-xref">Equation&nbsp;2</a> by choosing a superposition of <span class="math inline">\(e^{-i\omega_\pm t}\)</span> such that <span class="math inline">\(\chi'(0+)=m^{-1}\)</span></p>
<p><span class="math display">\[
\chi(t) = \begin{cases}
0 &amp; t\leq 0 \\
\frac{1}{m\omega_1}\sin(\omega_1 t )e^{-\gamma/2mt} &amp; t&gt;0.
\label{res_shogf}
\end{cases}
\]</span></p>
<p>The second method is to solve the equation <a href="#eq-chi-ode" class="quarto-xref">Equation&nbsp;2</a> in the Fourier domain, where it becomes</p>
<p><span class="math display">\[
\left[-m\omega^2+m\omega_0^2-i\gamma\omega\right]\tilde\chi(\omega) = 1,
\]</span></p>
<p>so that</p>
<p><span id="eq-chi-sho"><span class="math display">\[
\tilde\chi(\omega) = \frac{1}{m(\omega_0^2-\omega^2)-i\gamma\omega}.
\tag{3}\]</span></span></p>
<p>I’m going to assume that you’ve plotted the amplitude and phase of this function enough times in your life already. Fourier transforming back to the time domain</p>
<p><span id="eq-chi-FT"><span class="math display">\[
\chi(t) = \int_{-\infty}^\infty \tilde\chi(\omega)e^{-i\omega t}\,\frac{d\omega}{2\pi} = -\frac{1}{m} \int_{-\infty}^\infty \frac{e^{-i\omega t}}{(\omega-\omega_+)(\omega-\omega_-)}\,\frac{d\omega}{2\pi}.
\tag{4}\]</span></span></p>
<p>The integrand has two poles in the lower half plane at <span class="math inline">\(\omega_\pm\)</span>, on account of <span class="math inline">\(\gamma\)</span> being positive, which in turn follows from (or defines?) the direction of time. The fact that the frequency response is <em>analytic in the upper half plane</em> is equivalent to causality in the real time response. This is because for <span class="math inline">\(t&lt;0\)</span> we can close the contour in <a href="#eq-chi-FT" class="quarto-xref">Equation&nbsp;4</a> in the upper half plane, avoiding the poles and getting zero by Cauchy’s theorem. For <span class="math inline">\(t&gt;0\)</span> we close in the lower half plane (not forgetting the - from going the other way) and use the residue theorem to give</p>
<p><span class="math display">\[
\chi(t) = \frac{i}{m}\left(\frac{e^{-i\omega_+ t}}{\omega_+-\omega_-} + \frac{e^{-i\omega_- t}}{\omega_--\omega_+}\right) = \frac{1}{m\omega_1}\sin(\omega_1 t )e^{-\gamma/2mt} \quad  t&gt;0,
\]</span></p>
<p>as before.</p>
</section>
<section id="properties-of-the-susceptibility" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="properties-of-the-susceptibility"><span class="header-section-number">2.2</span> Properties of the Susceptibility</h3>
<p>(I’m going to drop the tilde from <span class="math inline">\(\tilde\chi(\omega)\)</span>, as there’s no real chance of confusion.)</p>
<p>We’ve already argued that causality dictates that <span class="math inline">\(\chi(\omega)\)</span> be analytic in the upper half plane. What is the implication for the response measured at <em>real</em> frequencies? Let’s split <span class="math inline">\(\chi(\omega)\)</span> into its real and imaginary parts</p>
<p><span class="math display">\[
\chi(\omega) = \chi'(\omega) + i\chi''(\omega).
\]</span></p>
<p>Then analyticity in the UHP implies the <strong>Kramers–Kronig relation</strong></p>
<p><span id="eq-kk"><span class="math display">\[
\chi'(\omega) = \mathcal{P}\int_{-\infty}^\infty \frac{d\omega'}{\pi}\frac{\chi''(\omega')}{\omega'-\omega},
\tag{5}\]</span></span></p>
<p>where <span class="math inline">\(\mathcal{P}\)</span> denotes the principal part. Since <span class="math inline">\(\chi(t)\)</span> is real, we have <span class="math inline">\(\chi(-\omega)^*=\chi(\omega)\)</span>, so that <span class="math inline">\(\chi'(\omega)\)</span> is an even function, while <span class="math inline">\(\chi''(\omega)\)</span> is odd.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>Check that <a href="#eq-chi-sho" class="quarto-xref">Equation&nbsp;3</a> satisfies <a href="#eq-kk" class="quarto-xref">Equation&nbsp;5</a>.</p>
</div>
</div>
<p>The real and imaginary parts encode different aspects of the response. The imaginary part is related to the power dissipated by a driving force. For <span class="math inline">\(f=f_0\cos\omega t\)</span> we have</p>
<p><span id="eq-class-diss"><span class="math display">\[
\begin{aligned}
W_\text{diss} = \langle f(t) \dot y(t)\rangle = \frac{1}{2}\omega\chi''(\omega)f_0^2.
\end{aligned}
\tag{6}\]</span></span></p>
<p>For stability we must have <span class="math inline">\(\omega\chi''(\omega)&gt;0\)</span> (and even).</p>
<p>The real part is related to the shift in the <em>energy</em> of the system in the presence of a driving force. Recalling that the applied force appears in the Hamiltonian as <span class="math inline">\(-f(t)y(t)\)</span>, we find the time average</p>
<p><span class="math display">\[
E_\text{shift} = -\langle f(t) y(t)\rangle  = -\frac{1}{2}\chi'(\omega)f_0^2
\]</span></p>
<p>For the damped oscillator, the sign of <span class="math inline">\(\chi'(\omega)\)</span> changes at resonance. The drive lowers the energy beneath the resonance, and raises it above.</p>
</section>
<section id="mechanical-model-of-dissipation" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="mechanical-model-of-dissipation"><span class="header-section-number">2.3</span> Mechanical Model of Dissipation</h3>
<p>When we move on to the quantum oscillator, we’re going to run into the problem that we only know how to describe Hamiltonian time evolution in quantum mechanics, that is, without dissipation. It’s possible to describe the damped oscillator in Hamiltonian terms at the expense of explicitly introducing the degrees of freedom that are doing the dissipating. You’ve met this in the realm of classical mechanics when you discuss the mechanical impedance of an elastic string.</p>
<p>Attaching an undamped oscillator to a string under tension <span class="math inline">\(\tau\)</span> gives the coupled system</p>
<p><span class="math display">\[
\begin{aligned}
&amp;m\ddot y +m\omega_0^2 y =\tau\frac{\partial u(x,t)}{\partial x}\Bigg|_{x=0}\nonumber\\
&amp;\frac{\partial^2 u}{\partial x^2}-\frac{1}{c^2}\frac{\partial^2 u}{\partial t^2}=0,\quad x&gt;0\qquad u(0,t) = y(t).
\label{res_SHOString}
\end{aligned}
\]</span></p>
<p>The model was orinally studied by Horace Lamb in a 1900 paper titled <a href="https://londmathsoc.onlinelibrary.wiley.com/doi/abs/10.1112/plms/s1-32.1.208">“On a Peculiarity of the Wave‐System due to the Free Vibrations of a Nucleus in an Extended Medium”</a>. Lamb wasn’t talking about the nucleus of the atom — that hadn’t yet been discovered — but of any body coupled to a continuum.</p>
<p>If nothing is propagating towards the oscillator from the string, only away from it, we can write <span id="eq-ret"><span class="math display">\[
u(x,t) = y(t-x/c).
\tag{7}\]</span></span></p>
<p>This gives <span class="math inline">\(\frac{\partial u(x,t)}{\partial x}\big\|_{x=0} = -\dot y/c\)</span>, and hence a closed equation for <span class="math inline">\(y\)</span></p>
<p><span class="math display">\[
\ddot y +\omega_0^2 y + \gamma \dot y =0.
\label{res_sho2}
\]</span></p>
<p>with <span class="math inline">\(\gamma=\tau/c\)</span>. Note that this is the impedance of the string.</p>
<p>The nice thing about this model is that it is very explicit. In particular, we can see exactly where the arrow of time comes from: the assumption <a href="#eq-ret" class="quarto-xref">Equation&nbsp;7</a>. Had we somehow arranged to have an incoming wave that matched the motion of the oscillator, we would arrive at an equation of motion for the oscillator with damping of the other sign.</p>
<p>Although we’ve introduced response functions for a linear system, this isn’t a requirement (fortunately). More generally, we can ask how the (nonlinear) motion of a system is modified at first order in some perturbation – a force in the case of the oscillator. The susceptibility describes the <strong>linear response</strong> of the system. Many quantities that we meet in elementary physics such as elastic constants and conductance (electrical and thermal) are really linear response functions that represent a convenient first approximation to the true nonlinear behaviour.</p>
</section>
<section id="finite-temperature-fluctuations" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="finite-temperature-fluctuations"><span class="header-section-number">2.4</span> Finite Temperature Fluctuations</h3>
<p><a href="#eq-ret" class="quarto-xref">Equation&nbsp;7</a> corresponds to a ‘zero temperature’ environment. Finite temperature corresponds to an ‘incoming’ wave describing the thermal occupation of the Fourier modes of the string, which would cause Brownian motion of the oscillator. The energy scale of this motion is <span class="math inline">\(k_\text{B}T\)</span>.</p>
<p>We can easily extend the earlier discussion to finite temperature by writing <span class="math inline">\(u(x,t)\)</span> in terms of components approaching and leaving the oscillator</p>
<p><span class="math display">\[
u(x,t) = u_\text{in}(t+x/c) + u_\text{out}(t-x/c).
\]</span></p>
<p>The force on the oscillator is proportional to</p>
<p><span class="math display">\[
\frac{\partial u(x,t)}{\partial x}\Bigg|_{x=0} = c^{-1}\left(u'_\text{in}(t)-u'_\text{out}(t)\right) = c^{-1}\left(2u'_\text{in}(t)-\dot y(t)\right).
\]</span></p>
<p>The equation of motion can then be written as</p>
<p><span id="eq-sho-noise"><span class="math display">\[
m\ddot y +m\omega_0^2 y + \gamma \dot y =f_\text{noise}(t),
\tag{8}\]</span></span></p>
<p>where <span class="math inline">\(f_\text{noise}(t) = \frac{2\tau}{c}u'_\text{in}(t)\)</span> is a random force due to thermal fluctuations. As this derivation makes clear, the noise and the damping have a common origin.</p>
<p>On account of the infinite bandwidth of the string, <span class="math inline">\(f_\text{noise}\)</span> is white noise</p>
<p><span id="eq-noise-var"><span class="math display">\[
\mathbb{E}\left[f_\text{noise}(t)f_\text{noise}(t')\right] = 2\gamma k_\text{B}T\delta(t-t').
\tag{9}\]</span></span></p>
<p>A differential equation driven by noise like <a href="#eq-sho-noise" class="quarto-xref">Equation&nbsp;8</a> is known as a <strong>Langevin equation</strong> in physics and as a <strong>stochastic differential equation</strong> (SDE) in mathematics.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Actually, no self-respecting mathematician would write something like <a href="#eq-sho-noise" class="quarto-xref">Equation&nbsp;8</a>, implying as it does that the instantaneous acceleration of the oscillator is infinite. Physicists, on the other hand, know that this is just an approximation caused by setting certain time scales to zero.</p>
</div>
</div>
<p>The mathematical way to write an equation like <a href="#eq-sho-noise" class="quarto-xref">Equation&nbsp;8</a> is as the pair of first order SDEs</p>
<p><span class="math display">\[
\begin{aligned}
dy &amp;= \frac{p}{m} dt\nonumber \\
dp &amp;= -m\left[\omega_0^2 y +\gamma p\right]dt +\sqrt{2\gamma k_\text{B}T}dW,
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(W\)</span> is a <a href="https://en.wikipedia.org/wiki/Wiener_process">Wiener process</a>. Writing the equation in terms of differentials avoids the awkward subject of infinite forces.</p>
<p>The motion of the oscillator in response to the thermal noise can be calculated using the response function. In the frequency domain, <a href="#eq-noise-var" class="quarto-xref">Equation&nbsp;9</a> is</p>
<p><span class="math display">\[
\mathbb{E}\left[\tilde f_\text{noise}(\omega)\tilde f_\text{noise}(\omega')\right] = 4\pi \gamma k_\text{B}T\delta(\omega+\omega'),
\]</span></p>
<p>giving a power spectrum of oscillator fluctuations</p>
<p><span id="eq-power"><span class="math display">\[
\mathbb{E}\left[\tilde y(\omega)\tilde y(\omega')\right] = 4\pi \gamma k_\text{B}T |\chi(\omega)|^2 \delta(\omega+\omega').
\tag{10}\]</span></span></p>
<p>Noting that</p>
<p><span class="math display">\[
\chi''(\omega) =  \frac{\gamma \omega}{(\omega_0^2-\omega^2)^2+\gamma^2\omega^2} = \gamma\omega |\chi(\omega)|^2
\]</span></p>
<p>we can write <a href="#eq-power" class="quarto-xref">Equation&nbsp;10</a> as</p>
<p><span id="eq-power-final"><span class="math display">\[
\mathbb{E}\left[\tilde y(\omega)\tilde y(\omega')\right] = 2\pi S(\omega)\delta(\omega+\omega'),
\tag{11}\]</span></span></p>
<p>where</p>
<p><span id="eq-classical-fdt"><span class="math display">\[
S(\omega)=\frac{2k_\text{B}T}{\omega} \chi''(\omega).
\tag{12}\]</span></span></p>
<p>Note that <span class="math inline">\(S(\omega)=S(-\omega)\)</span> on account of <span class="math inline">\(\chi''(\omega)\)</span> being odd. This result tells us that the fluctuations and response of our oscillator are related to each other. This is actually rather natural – the fluctuations are a response to the thermal noise felt by the system. Since it is <span class="math inline">\(\chi''(\omega)\)</span> – the dissipative part of the response – that appears in <a href="#eq-classical-fdt" class="quarto-xref">Equation&nbsp;12</a>, relations of this sort are called <strong>fluctuation–dissipation relations</strong>. We’ll meet the quantum version next.</p>
</section>
<section id="quantum-fluctuations" class="level3" data-number="2.5">
<h3 data-number="2.5" class="anchored" data-anchor-id="quantum-fluctuations"><span class="header-section-number">2.5</span> Quantum Fluctuations</h3>
<p>Quantum mechanics provides another source of fluctuations. For a single (undamped) oscillator</p>
<p><span class="math display">\[
H = \frac{p^2}{2m} + \frac{1}{2}m\omega_0^2 y^2,
\]</span></p>
<p>we have the ground state fluctuations</p>
<p><span class="math display">\[
\langle{0}\rvert y^2 \lvert{0}\rangle = \frac{1}{2m \omega_0},
\]</span></p>
<p>while at finite temperature</p>
<p><span class="math display">\[
\langle\langle y^2\rangle\rangle=\mathrm{tr}\left[\rho\, y^2\right] = \frac{\coth(\beta\omega_0/2)}{2m\omega_0}.
\]</span></p>
<p>where <span class="math inline">\(\rho = e^{-\beta H}/Z\)</span> is the equilibrium density matrix, and <span class="math inline">\(Z=\mathrm{tr}[e^{-\beta H}]\)</span> is the partition function. The double angular brackets <span class="math inline">\(\langle\langle (\cdots)\rangle\rangle\)</span> denote that we are taking quantum <em>and thermal</em> expectations.</p>
<p>Now what about <em>time dependent fluctuations</em>? This is what was calculated in <a href="#eq-power-final" class="quarto-xref">Equation&nbsp;11</a> for the classical damped oscillator. A natural candidate is</p>
<p><span class="math display">\[
\langle\langle y(t)y(0)\rangle\rangle,
\]</span></p>
<p>where <span class="math inline">\(y(t)\)</span> denotes the Heisenberg picture time evolution <span class="math inline">\(y(t) = e^{iHt} y e^{-iHt}\)</span>. This gives for the <em>quantum</em> noise spectrum</p>
<p><span id="eq-q-noise"><span class="math display">\[
S(\omega) = \int_{-\infty}^\infty \langle\langle y(t)y(0)\rangle\rangle e^{i\omega t}\,dt.
\tag{13}\]</span></span></p>
<p>So far, this is a purely formal definition – we have to figure out what it means. The first and most important thing to notice is that, since <span class="math inline">\(y(0)\)</span> and <span class="math inline">\(y(t)\)</span> do not commute with each other <span class="math inline">\(\langle\langle y(t)y(0)\rangle\rangle\neq \langle\langle y(0)y(t)\rangle\rangle=\langle\langle y(-t)y(0)\rangle\rangle\)</span>. Hence</p>
<p><span class="math display">\[
S(\omega)\neq S(-\omega).
\]</span></p>
<p>Many of the properties of this function are most easily understood from a <strong>spectral representation</strong>, which is obtained by inserting a complete set of energy eigenstates between <span class="math inline">\(y(0)\)</span> and <span class="math inline">\(y(t)\)</span> in <a href="#eq-q-noise" class="quarto-xref">Equation&nbsp;13</a>. This gives</p>
<p><span id="eq-s-spectral"><span class="math display">\[
S(\omega) = 2\pi\sum_{m,n} \frac{e^{-\beta E_n}}{Z} |\langle{n}\rvert y\lvert{m}\rangle|^2 \delta(\omega-E_m+E_n).
\tag{14}\]</span></span></p>
<p>This expression is completely general, but already it is possible to see what is going on. The reason for the asymmetry in <span class="math inline">\(S(\omega)\)</span> is that the term with <span class="math inline">\(\delta(\omega-E_m+E_n)\)</span> is weighted by <span class="math inline">\(e^{-\beta E_n}\)</span>, while the term with <span class="math inline">\(\delta(\omega-E_n+E_m)\)</span> has <span class="math inline">\(e^{-\beta E_m}\)</span>. Thus we can say</p>
<p><span id="eq-noise-asym"><span class="math display">\[
S(\omega) = S(-\omega) e^{\beta\omega}.
\tag{15}\]</span></span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>There seems to be room for disagreement about how to define <span class="math inline">\(S(\omega)\)</span>. <span class="citation" data-cites="chaikin2000principles">Chaikin and Lubensky (<a href="#ref-chaikin2000principles" role="doc-biblioref">2000</a>)</span> and <span class="citation" data-cites="nozieres2018theory">Nozieres (<a href="#ref-nozieres2018theory" role="doc-biblioref">2018</a>)</span> have it this way, <span class="citation" data-cites="nazarov2013advanced">Nazarov and Danon (<a href="#ref-nazarov2013advanced" role="doc-biblioref">2013</a>)</span> have the energy axis inverted. It comes down to whether you want to think about energy going to or from the system (see later).</p>
</div>
</div>
<p>At zero temperature <span class="math inline">\(\beta\to\infty\)</span> and we can see that <span class="math inline">\(S(\omega&lt;0)=0\)</span>.</p>
<p>Let’s evaluate <a href="#eq-s-spectral" class="quarto-xref">Equation&nbsp;14</a> for the oscillator. The matrix elements are</p>
<p><span class="math display">\[
\langle{n}\rvert y\lvert{m}\rangle = \frac{1}{\sqrt{2m\omega_0}}\begin{cases}
\sqrt{m+1} &amp; \text{if } n=m+1 \\
\sqrt{m} &amp; \text{if } n=m-1.
\end{cases}
\]</span></p>
<p>Giving</p>
<p><span id="eq-qSHO-noise"><span class="math display">\[
\begin{aligned}
S(\omega)&amp;=\frac{\pi}{m\omega_0} \sum_n \frac{e^{-\beta E_n}}{Z} \left[n\delta(\omega+\omega_0)+(n+1)\delta(\omega-\omega_0)\right]\nonumber\\
&amp; = \frac{\pi}{m\omega_0}\left[n_\text{B}(\omega_0)\delta(\omega+\omega_0)+(n_\text{B}(\omega_0)+1)\delta(\omega-\omega_0)\right]
\end{aligned}
\tag{16}\]</span></span></p>
<p>where</p>
<p><span class="math display">\[
n_\text{B}(\omega)\equiv \frac{1}{\exp\left(\beta\omega\right)-1},
\]</span></p>
<p>is the Bose distribution function. <a href="#eq-qSHO-noise" class="quarto-xref">Equation&nbsp;16</a> shows the predicted asymmetry between positive and negative frequencies. We can check that</p>
<p><span class="math display">\[
\int S(\omega)\frac{d\omega}{2\pi} = \langle\langle y^2\rangle\rangle= \frac{\coth(\beta\omega_0/2)}{2m\omega_0},
\]</span></p>
<p>as we found before.</p>
<p>Our discussion of the single oscillator can be generalized to a system of coupled oscillators, of which our damped spring is an example. Although we won’t carry out the transformation explicitly, we could express the <span class="math inline">\(y(t)\)</span> in terms of a system of normal modes as</p>
<p><span id="eq-y-mode"><span class="math display">\[
y(t) = \sum_k \left[c^{}_k a^\dagger_k(t) + c_k^* a^{\vphantom{\dagger}}_k(t)\right],
\tag{17}\]</span></span></p>
<p>where the time evolution of the mode operators is</p>
<p><span class="math display">\[
a^\dagger_k(t) = e^{i\omega_k t}a^\dagger_k,\quad a^{\vphantom{\dagger}}_k(t) = e^{-i\omega_k t}a^{\vphantom{\dagger}}_k.
\]</span></p>
<p>Repeating the calculation of <span class="math inline">\(S(\omega)\)</span> gives</p>
<p><span id="eq-qSHO-noise-gen"><span class="math display">\[
\begin{aligned}
S(\omega)= 2\pi\sum_k |c_k|^2\left[n_\text{B}(\omega_k)\delta(\omega+\omega_k)+(n_\text{B}(\omega_k)+1)\delta(\omega-\omega_k)\right].
\end{aligned}
\tag{18}\]</span></span></p>
<p>With a continuum of modes, as in the oscillator coupled to a string, <span class="math inline">\(S(\omega)\)</span> can have a smooth (not just <span class="math inline">\(\delta\)</span>-function like) behaviour. Nevertheless, the basic relation <a href="#eq-noise-asym" class="quarto-xref">Equation&nbsp;15</a> is still obeyed.</p>
<p>Now, we’ll show that <span class="math inline">\(S(\omega)\)</span> is related to the <em>response</em> of our quantum system, just as in the classical case. For a system of oscillators, finding the response is actually no harder, as the Heisenberg equations of motion in the presence of a driving force are exactly the same as in the classical case. Thus the response is the same. In terms of the normal modes the Hamiltonian looks like</p>
<p><span class="math display">\[
H = \sum_k \omega_k a^\dagger_ka^{\vphantom{\dagger}}_k - f(t)y,
\]</span></p>
<p>where <span class="math inline">\(y\)</span> is written in terms of the normal modes as in <a href="#eq-y-mode" class="quarto-xref">Equation&nbsp;17</a>. The equation of motion for the modes is</p>
<p><span class="math display">\[
\frac{da^{\vphantom{\dagger}}_k}{dt} = -i\omega_k a^{\vphantom{\dagger}}_k +i c_k f(t),
\]</span></p>
<p>so that the response of the oscillator is <span class="math inline">\(a^{\vphantom{\dagger}}_k(t) = e^{-i\omega_k t}a^{\vphantom{\dagger}}_k(0)+a_{k,f}(t)\)</span> with the driven response <span class="math inline">\(a_{k,f}(t)\)</span> being a number (not an operator) with Fourier components</p>
<p><span class="math display">\[
a^{\vphantom{\dagger}}_{k,f}(\omega) \equiv \frac{c_k}{\omega_k-\omega-i0} f(\omega).
\]</span></p>
<p>Note the imaginary infinitesimal in the denominator. This is a notational device to remind us that, even though the normal mode has no damping, a causal (retarded) response is analytic in the upper half plane of <span class="math inline">\(\omega\)</span>. The response of <span class="math inline">\(y(\omega)\)</span> is then obtained from <a href="#eq-y-mode" class="quarto-xref">Equation&nbsp;17</a> <span class="math display">\[
y(\omega) = \sum_k |c_k|^2\left[\frac{1}{\omega_k-\omega-i0}+\frac{1}{\omega_k+\omega+i0}\right]f(\omega).
\]</span></p>
<p>Thus we have</p>
<p><span id="eq-chi-modes"><span class="math display">\[
\chi(\omega) = \sum_k |c_k|^2\left[\frac{1}{\omega_k-\omega-i0}+\frac{1}{\omega_k+\omega+i0}\right],
\tag{19}\]</span></span></p>
<p>but we also know the LHS from the classical calculation <a href="#eq-chi-sho" class="quarto-xref">Equation&nbsp;3</a>.</p>
<p><a href="#eq-qSHO-noise-gen" class="quarto-xref">Equation&nbsp;18</a> and <a href="#eq-chi-modes" class="quarto-xref">Equation&nbsp;19</a> are rather similar. We can get an explicit relation by using the formula</p>
<p><span class="math display">\[
\text{Im}\, \frac{1}{x\mp i0} = \pm\pi\delta(x),
\]</span></p>
<p>which you can prove by allowing the infinitesimal to be finite, and then letting it go to zero. We can then show</p>
<p><span class="math display">\[
\chi''(\omega) = \pi\sum_k |c_k|^2\delta(\omega_k-\omega),\quad \omega&gt;0,
\label{res_Imchi_modes}
\]</span></p>
<p>with <span class="math inline">\(\chi''(-\omega)=-\chi''(\omega)\)</span>. Comparing with the classical answer <a href="#eq-chi-sho" class="quarto-xref">Equation&nbsp;3</a> allows us to to find the <span class="math inline">\(|c_k|\)</span> without having to go through the trouble of finding the normal modes explicitly (although we’d be using our knowledge of their density of states).</p>
<p><span class="math inline">\(S(\omega)\)</span> and <span class="math inline">\(\chi''(\omega)\)</span> are then related by</p>
<p><span id="eq-FDT-asym"><span class="math display">\[
S(\omega) = 2\chi''(\omega)\left[n_\text{B}(\omega)+1\right].
\tag{20}\]</span></span></p>
<p>This is a quantum fluctuation dissipation relation.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>Check that <a href="#eq-FDT-asym" class="quarto-xref">Equation&nbsp;20</a> reduces to <a href="#eq-classical-fdt" class="quarto-xref">Equation&nbsp;12</a> in the classical limit. It may help to (just this once) put <span class="math inline">\(\hbar\)</span> back in and then let it go to zero.</p>
</div>
</div>
</section>
<section id="golden-rule-and-dissipation" class="level3" data-number="2.6">
<h3 data-number="2.6" class="anchored" data-anchor-id="golden-rule-and-dissipation"><span class="header-section-number">2.6</span> Golden Rule and Dissipation</h3>
<p>We argued for the classical damped oscillator – actually our discussion is true more generally – that <span class="math inline">\(\text{Im}\,\chi(\omega)\)</span> is related to the dissipation of energy. Now we have found a relation between this quantity and our quantum noise spectrum <span class="math inline">\(S(\omega)\)</span>. Can we see directly how <span class="math inline">\(S(\omega)\)</span> is connected to energy dissipation?</p>
<p>The key is to regard the driving force as a perturbation that can cause transition between energy eigenstates. The perturbation is</p>
<p>$ H_ = - f(t)y, $</p>
<p>with <span class="math inline">\(f(t)=f_0\cos\omega t\)</span>. In lowest order perturbation theory, the system can make a transition either up or down in energy by <span class="math inline">\(\omega\)</span> The transition rates can be found from Fermi’s golden rule</p>
<p><span class="math display">\[
\Gamma_{n\to m} = 2\pi \left(\frac{f_0}{2}\right)^2|\langle{n}\rvert y\lvert{m}\rangle|^2 \delta(\pm\omega+E_m-E_n).
\]</span></p>
<p>The total rate of transitions changing the energy of the system by <span class="math inline">\(\omega\)</span> can then be found by summing the rates, accounting for the probability <span class="math inline">\(e^{-\beta E_n}/Z\)</span> of finding the system initially in eigenstate <span class="math inline">\(n\)</span></p>
<p><span class="math display">\[
\Gamma(\omega) = S(\omega)\left(\frac{f_0}{2}\right)^2.
\]</span></p>
<p>Thus <span class="math inline">\(S(\omega)\)</span> measures the rate at which transitions <em>absorbing</em> energy <span class="math inline">\(\omega\)</span> are occurring, and <span class="math inline">\(S(-\omega)\)</span> the corrsponding rate for emitting energy <span class="math inline">\(\omega\)</span>. The asymmetry of <span class="math inline">\(S(\omega)\)</span> is then interpreted as an inequality between emission and absorption of radiation, which is of course most extreme in the ground state. This is – eventually – a clear physical interpretation of the quantum noise spectrum <span class="math inline">\(S(\omega)\)</span>.</p>
<p>The rate of energy absorption is</p>
<p><span class="math display">\[
\omega\Gamma(\omega) = \omega S(\omega)\left(\frac{f_0}{2}\right)^2 = \frac{1}{2}\omega\chi''(\omega)\left[n_\text{B}(\omega)+1\right]f_0^2.
\label{res_absorb}
\]</span></p>
<p>Let’s compare with our previous expression for the energy dissipated, <a href="#eq-class-diss" class="quarto-xref">Equation&nbsp;6</a>. We see we have agreement for <span class="math inline">\(n_\text{B}(\omega)\to 0\)</span>. This corresponds to the energy of the transition being much larger than the thermal energy <span class="math inline">\(\hbar\omega\gg k_B T\)</span>.</p>
</section>
</section>
<section id="linear-response-formal-theory" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="linear-response-formal-theory"><span class="header-section-number">3</span> Linear Response: Formal Theory</h2>
<p>Our long discussion of the oscillator has laid the ground for some general definitions. Firstly, how do we talk about linear response in a general (quantum) system?</p>
<section id="kubo-formula" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="kubo-formula"><span class="header-section-number">3.1</span> Kubo Formula</h3>
<p>Suppose we want to determine how the expectation value of some observable <span class="math inline">\(A\)</span> depends on some quantity <span class="math inline">\(\lambda_t\)</span>, which appears (for small variations) linearly in the Hamiltonian</p>
<p><span class="math display">\[
H_t = H_0 - \lambda_t B.
\]</span></p>
<p>Recalling the oscillator, we call <span class="math inline">\(B=-\frac{\partial H}{\partial \lambda}\)</span> the <strong>generalized force</strong>, and <span class="math inline">\(\lambda\)</span> the <strong>generalized displacement</strong>. I’m writing the time dependence like this to distinguish it from the Heisenberg picture time evolution. We assume that <span class="math inline">\(A\)</span> has expectation value zero when <span class="math inline">\(\lambda=0\)</span>: we can just define it that way if necessary.</p>
<p>Viewing the time evolution of the state of the system <span class="math inline">\(\lvert{\Psi(t)}\rangle\)</span> in the interaction picture <span class="math inline">\(\lvert{\Psi_I(t)}\rangle \equiv e^{iH_0 t}\lvert{\Psi(t)}\rangle\)</span> gives</p>
<p><span class="math display">\[
i\frac{\partial \lvert{\Psi_I(t)}\rangle}{\partial t} = -\lambda_t B_I(t) \lvert{\Psi_I(t)}\rangle,
\]</span></p>
<p>where <span class="math inline">\(B_I(t) = e^{iH_0 t}B e^{-iH_0 t}\)</span>. The result of first order time dependent perturbation theory is the state <span class="math inline">\(\lvert{\Psi_I(t)}\rangle=\lvert{\Psi(0)}\rangle+\lvert{\Psi^{(1)}_I(t)}\rangle+\cdots\)</span>, with</p>
<p><span class="math display">\[
\lvert{\Psi^{(1)}_I(t)}\rangle = i\int_0^t dt' \lambda_{t'} B_I(t') \lvert{\Psi(0)}\rangle.
\]</span></p>
<p>The expectation value of <span class="math inline">\(A\)</span> is then</p>
<p><span class="math display">\[
\begin{aligned}
\langle{\Psi(t)}\rvert A\lvert{\Psi(t)}\rangle &amp;= \langle{\Psi_I(t)}\rvert A_I(t) \lvert{\Psi_I(t)}\rangle \nonumber\\
&amp;=\langle{\Psi(0)}\rvert A_I(t)\lvert{\Psi(0)}\rangle +i \int_0^t dt' \lambda_{t'}\langle{\Psi(0)}\rvert \left[A_I(t),B_I(t')\right] \lvert{\Psi(0)}\rangle.
\end{aligned}
\]</span></p>
<p>Mixed states can be treated by averaging over a distribution of quantum states – or one can look at the equation of motion of the density matrix directly. The result allows us to identify the response function <span class="math inline">\(\chi_{AB}(t)\)</span> of <span class="math inline">\(A\)</span> due to a perturbation that couples to <span class="math inline">\(B\)</span> as</p>
<p><span id="eq-kubo"><span class="math display">\[
\chi_{AB}(t) = i\langle\langle\left[A_I(t),B_I(0)\right]\rangle\rangle,\quad t&gt;0.
\tag{21}\]</span></span></p>
<p>Normally we write <span class="math inline">\(A(t)\)</span> rather than <span class="math inline">\(A_I(t)\)</span>, as this is the Heisenberg picture for the unperturbed problem. <a href="#eq-kubo" class="quarto-xref">Equation&nbsp;21</a> is known as the <strong>Kubo formula</strong>. It expresses the response of a system in terms of the dynamics of the unperturbed system.</p>
</section>
<section id="fluctuation-dissipation-theorem" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="fluctuation-dissipation-theorem"><span class="header-section-number">3.2</span> Fluctuation Dissipation Theorem</h3>
<p>The Kubo formula makes it clear that there is a connection between response functions and noise correlations. Let’s find the connection in its most general form. We start from the correlation function</p>
<p><span class="math display">\[
S_{AB}(t) \equiv \langle\langle A_I(t)B_I(0)\rangle\rangle.
\]</span></p>
<p>Recalling that <span class="math display">\[\langle\langle\cdots \rangle\rangle = \frac{1}{Z}\mathrm{tr}\left[e^{-\beta H}\cdots\right],\]</span> you should be able to show that</p>
<p><span class="math display">\[
S_{AB}(t) = S_{BA}(-t-i\beta).
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>Show this using the cyclic property of the trace.</p>
</div>
</div>
<p>Fourier transforming, we arrive at</p>
<p><span class="math display">\[
S_{AB}(\omega) = e^{\beta\omega} S_{BA}(-\omega).
\]</span></p>
<p>We’ve met an example of this relation before, see <a href="#eq-noise-asym" class="quarto-xref">Equation&nbsp;15</a>.</p>
<p><span class="math inline">\(\chi_{AB}(t)\)</span> can be written in terms of the correlations as</p>
<p><span class="math display">\[
\chi_{AB}(t) = \begin{cases}
i\left[S_{AB}(t)-S_{BA}(-t)\right] &amp; t&gt;0\\
0 &amp; t&lt;0.
\end{cases}
\]</span></p>
<p>We write this as <span class="math inline">\(\chi_{AB}(t) = i\theta(t)\langle\langle\left[A_I(t),B_I(0)\right]\rangle\rangle\)</span>, where <span class="math inline">\(\theta(t)\)</span> is the step function</p>
<p><span class="math display">\[
\theta(t)=\begin{cases}
1 &amp; t\geq 0\\
0 &amp; t&lt;0
\end{cases}.
\]</span></p>
<p>Consider now the dissipative part of <span class="math inline">\(\chi_{AB}(t)\)</span></p>
<p><span class="math display">\[
\tilde\theta(\omega) = \frac{i}{\omega+i0},
\]</span></p>
<p>giving</p>
<p><span id="eq-conv"><span class="math display">\[
\begin{aligned}
\chi_{AB}(\omega)&amp;= -\int \frac{d\omega'}{2\pi}\frac{S_{AB}(\omega')-S_{BA}(-\omega')}{\omega-\omega'+i0}\\
&amp;=-\int \frac{d\omega'}{2\pi}\frac{S_{AB}(\omega')\left[1-e^{-\beta\omega'}\right]}{\omega-\omega'+i0}.
\end{aligned}
\tag{22}\]</span></span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>Verify that this function appears in dissipative response. Hint: consider the change of the expectation value of the energy <span class="math inline">\(E=\mathrm{tr}[\rho H]\)</span> due to a perturbation <span class="math inline">\(\sum_{i}\left( f_i e^{-i\omega t} + f_i^* e^{i\omega t}\right) O_i\)</span>. If stuck, see <span class="citation" data-cites="chaikin2000principles">Chaikin and Lubensky (<a href="#ref-chaikin2000principles" role="doc-biblioref">2000</a>)</span> Section 7.6.3.</p>
</div>
</div>
<p><span id="eq-kk-chi"><span class="math display">\[
\begin{aligned}
\chi_{AB}(\omega) &amp;=\chi'(\omega) + i\chi''(\omega)\\
&amp;= \mathcal{P}\int_{-\infty}^\infty \frac{d\omega'}{\pi}\frac{\chi''(\omega')}{\omega'-\omega} + i\chi''(\omega)\\
&amp;= \int_{-\infty}^\infty \frac{d\omega'}{\pi}\frac{\chi''(\omega')}{\omega'-\omega-i0},
\end{aligned}
\tag{23}\]</span></span></p>
<p>The Fourier transform of this function is</p>
<p><span class="math display">\[
\chi_{AB}''(\omega)=\frac{1}{2} \left(S_{AB}(\omega)-S_{BA}(-\omega)\right).
\]</span> Finally, we obtain</p>
<p><span id="eq-fdt-gen"><span class="math display">\[
S_{AB}(\omega) = 2\chi_{AB}''(\omega)\left[n_\text{B}(\omega)+1\right].
\tag{24}\]</span></span></p>
<p>This is the most general form of the quantum fluctuation dissipation relation, which we met before in the case of the oscilator, see <a href="#eq-FDT-asym" class="quarto-xref">Equation&nbsp;20</a>.</p>
</section>
<section id="spectral-representation" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="spectral-representation"><span class="header-section-number">3.3</span> Spectral Representation</h3>
<p>The quantites <span class="math inline">\(\chi_{AB}(\omega)\)</span> and <span class="math inline">\(S_{AB}(\omega)\)</span> have spectral representations in terms of the energy eigenstates and eigenvalues. For example,</p>
<p><span class="math display">\[
S_{AB}(\omega)  = 2\pi\sum_{m,n} \frac{e^{-\beta E_m}}{Z} \langle{m}\rvert A\lvert{n}\rangle\langle{n}\rvert B\lvert{m}\rangle \delta(\omega-E_n+E_m).
\label{res_SABSpectral}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>Use the spectral representation to prove the fluctuation dissipation relation <a href="#eq-fdt-gen" class="quarto-xref">Equation&nbsp;24</a>.</p>
</div>
</div>
<p>The function <span class="math inline">\(S_{AA}(\omega)\)</span> can be interpreted in terms of the Fermi golden rule, as we saw in the case of the oscillator. Notice that <span class="math inline">\(S_{AA}(\omega)&gt;0\)</span>.</p>
</section>
</section>
<section id="response-of-matter" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="response-of-matter"><span class="header-section-number">4</span> Response of Matter</h2>
<p>Let’s now consider a response function typical of a many body system</p>
<section id="density-response" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="density-response"><span class="header-section-number">4.1</span> Density Response</h3>
<p>Suppose a system is subject to a time dependent potential – due to an electric field for example – corresponding to a term in the Hamiltonian</p>
<p><span class="math display">\[
H_\text{pert} = \sum_{j=1}^N V(\mathbf{r}_i,t) = \int  V(\mathbf{r},t)\rho(\mathbf{r})\, d\mathbf{r}= \frac{1}{L^3}\sum_\mathbf{q}V_\mathbf{q}(t) \rho_{-\mathbf{q}}.
\]</span></p>
<p>This perturbation couples to the density, and we ask how the density is affected by it. In a translationally invariant system</p>
<p><span class="math display">\[
\langle\langle \rho_\mathbf{q}(t)\rangle\rangle = -\frac{1}{L^3} \int_{-\infty}^t  \chi^{\rho}_\mathbf{q}(t-t') V_\mathbf{q}(t)\,dt',
\]</span></p>
<p>where the density response function <span class="math inline">\(\chi^\rho_\mathbf{q}(t)\)</span> is</p>
<p><span class="math display">\[
\chi_\rho(\mathbf{q},t) = i\langle\langle\left[\rho_\mathbf{q}(t),\rho_{-\mathbf{q}}(0)\right]\rangle\rangle.
\label{res_kubo_density}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>What is the role of translational invariance?</p>
</div>
</div>
<p>The general theory described above applies here with <span class="math inline">\(A=\rho_\mathbf{q}\)</span> and <span class="math inline">\(B=\rho_{-\mathbf{q}}\)</span>. Focusing on the case of zero temperature, we have the spectral representation of the correlation function</p>
<p><span id="eq-S-def"><span class="math display">\[
S_\rho(\mathbf{q},\omega) = 2\pi\sum_{n}  |\langle{0}\rvert\rho_\mathbf{q}\lvert{n}\rangle|^2 \delta(\omega-E_n+E_0),
\tag{25}\]</span></span></p>
<p>where we have used <span class="math inline">\(\rho_\mathbf{q}^\dagger=\rho_{-\mathbf{q}}^{}\)</span>. This quantity is called the <strong>dynamical structure factor</strong>, on account of its importance in scattering experiments. It gives the rate at which the system makes transitions that impart energy <span class="math inline">\(\omega\)</span> and momentum <span class="math inline">\(\mathbf{q}\)</span> in the presence of the perturbation <span class="math inline">\(H_\text{pert}\)</span>.</p>
<p>The integral</p>
<p><span class="math display">\[
S_\rho(\mathbf{q}) = \int S_\rho(\mathbf{q},\omega) \frac{d\omega}{2\pi} = \langle\langle\rho_\mathbf{q}\rho_{-\mathbf{q}}\rangle\rangle
\]</span></p>
<p>is usually called the <strong>static structure factor</strong>, which is a bit of a strange name given that it contains all frequencies. A better name would perhaps be <em>equal time</em> structure factor. <span class="math inline">\(S_\rho(\mathbf{q})\)</span> quantifies the density fluctuations in a system. It is related to the quantity <span class="math inline">\(\rho_2(\mathbf{r}_1,\mathbf{r}_2)\)</span> considered in <a href="[ref []{.quarto-shortcode__-param data-is-shortcode=&quot;1&quot; data-value=&quot;many-body-wavefunctions&quot; data-raw=&quot;&quot;many-body-wavefunctions&quot;&quot;} ]{.quarto-shortcode__ data-is-shortcode=&quot;1&quot; data-raw=&quot;{{< ref &quot;many-body-wavefunctions&quot; >}}&quot;}">Lecture 1</a> since</p>
<p><span class="math display">\[
\rho_2(\mathbf{r}_1,\mathbf{r}_2) = \langle{\Psi}\rvert\rho(\mathbf{r}_1)\rho(\mathbf{r}_2)\lvert{\Psi}\rangle - \rho_1(\mathbf{r}_1)\delta(\mathbf{r}_1-\mathbf{r}_2).
\]</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Some texts (e.g <span class="citation" data-cites="nozieres2018theory">Nozieres (<a href="#ref-nozieres2018theory" role="doc-biblioref">2018</a>)</span>) omit the <span class="math inline">\(2\pi\)</span> in the definition <a href="#eq-S-def" class="quarto-xref">Equation&nbsp;25</a>. I prefer to keep it so that <span class="math inline">\(S_\rho(\mathbf{q},t) = \langle\langle \rho_\mathbf{q}(t)\rho_{-\mathbf{q}}(0)\rangle\rangle\)</span>.</p>
</div>
</div>
</section>
<section id="sum-rules" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="sum-rules"><span class="header-section-number">4.2</span> Sum rules</h3>
<p><span class="math inline">\(S_\rho(\mathbf{q},\omega)\)</span> obeys certain relations irrespective of the particular model under consideration. Since these usually involve integrals over the whole range of energy, they are known as <strong>sum rules</strong>. By constraining the form of <span class="math inline">\(S_\rho(\mathbf{q},\omega)\)</span>, sum rules may be used to prove general statements or check the validity of approximations.</p>
<p>We start with the <strong>f-sum rule</strong>. This follows from considering the double commutator <span class="math inline">\([[H,\rho_\mathbf{q}],\rho_{-\mathbf{q}}]\)</span>. In a system where the interaction depends only on density, the interaction commutes with <span class="math inline">\(\rho_\mathbf{q}\)</span>, so the commutator is determined by the kinetic energy</p>
<p><span class="math display">\[
T = -\frac{1}{2m}\sum_{j=1}^N \nabla_i^2.
\]</span></p>
<p>(We could also consider lattice models, with their own kinetic energy, but we’ll stick with the simplest version). Taking <span class="math inline">\(\rho_\mathbf{q}=\sum_{j=1}^N e^{-i\mathbf{q}\cdot\mathbf{r}_j}\)</span>, we find</p>
<p><span class="math display">\[
[[H,\rho_\mathbf{q}],\rho_{-\mathbf{q}}] = -\frac{N\mathbf{q}^2}{m}.
\]</span></p>
<p>The left hand side can be written in terms of <span class="math inline">\(S_\rho(\mathbf{q},\omega)\)</span>, giving the f-sum rule</p>
<p><span class="math display">\[
\int_{-\infty}^\infty \omega S(\mathbf{q},\omega) \frac{d\omega}{2\pi}= \frac{N\mathbf{q}^2}{2m}.
\]</span></p>
<p>Next we discuss the <strong>compressibility sum rule</strong>. The compressibility is defined in terms of the volume <span class="math inline">\(V\)</span> and pressure <span class="math inline">\(p\)</span> as</p>
<p><span class="math display">\[
\beta=-\frac{1}{V}\frac{\partial V}{\partial p}.
\]</span></p>
<p>At zero temperature, the pressure is</p>
<p><span class="math display">\[
p = -\frac{\partial E_0}{\partial V},
\]</span></p>
<p>where <span class="math inline">\(E_0\)</span> is the ground state energy. Since energy is an extensive quentity we expect <span class="math inline">\(E_0 = V \epsilon(\rho)\)</span>, where <span class="math inline">\(\rho = N/V\)</span> is the density, and <span class="math inline">\(\epsilon(\rho)\)</span> the energy per unit volume. Then</p>
<p><span class="math display">\[
\beta^{-1} = \rho^2 \epsilon''(\rho).
\]</span></p>
<ul>
<li>In the presence of a potential <span class="math inline">\(V(\mathbf{r})\)</span>, energy density is</li>
</ul>
<p><span class="math display">\[
\epsilon(\rho_0+\delta\rho) = \frac{1}{2\beta\rho_0^2} \left[\delta\rho\right]^2 + V(\mathbf{r})\delta\rho
\]</span></p>
<ul>
<li>Minimizing with respect to <span class="math inline">\(\delta\rho\)</span> gives</li>
</ul>
<p><span class="math display">\[
\epsilon(V(\mathbf{r})) = - \frac{\beta\rho_0^2}{2} \left[V(\mathbf{r})\right]^2
\]</span></p>
<ul>
<li>Compare with perturbation theory</li>
</ul>
<p>Recall that the chemical potential <span class="math inline">\(\mu = \frac{\partial E_0}{\partial N}=\epsilon'(\rho)\)</span>. Then</p>
<p><span class="math display">\[
\beta = \rho^{-2} \frac{\partial \rho}{\partial \mu} = \frac{1}{\rho N}\chi'(0,0).  
\]</span></p>
<p>Now <span class="math inline">\(\chi'(\mathbf{q},\omega)\)</span> can be written in terms of <span class="math inline">\(\chi''(\mathbf{q},\omega)\)</span> (Kramers–Kronig) and <span class="math inline">\(\chi''(\mathbf{q},\omega)\)</span> is related to <span class="math inline">\(S_\rho(\mathbf{q},\omega)\)</span>. This gives the compressibility sum rule at zero temperature</p>
<p><span class="math display">\[
\lim_{\mathbf{q}\to 0}\int_0^\infty \frac{S(\mathbf{q},\omega)}{\omega}\frac{d\omega}{2\pi} = \frac{N\rho\kappa}{2}.
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>Why do we need <span class="math inline">\(\lim_{\mathbf{q}\to 0}\)</span>?</p>
</div>
</div>
<p>The compressibility sum rule is often written in terms of the speed of sound <span class="math inline">\(c = (\kappa m \rho)^{-1/2}\)</span> as</p>
<p><span class="math display">\[
\lim_{\mathbf{q}\to 0}\int_0^\infty \frac{S(\mathbf{q},\omega)}{\omega}\frac{d\omega}{2\pi} = \frac{N}{2mc^2}.
\]</span></p>
<p>Let’s consider a simple example. Some systems, notably Bose gases, have a zero temperature dynamical structure factor that at low momentum has the following approximate form</p>
<p><span id="eq-sma"><span class="math display">\[
S_\rho(\mathbf{q},\omega) \sim 2\pi S_\rho(\mathbf{q}) \delta(\omega - \omega(\mathbf{q})),
\tag{26}\]</span></span></p>
<p>where <span class="math inline">\(\omega(\mathbf{q})\)</span> is the dispersion relation of the collective excitations. In reality, the <span class="math inline">\(\delta\)</span>-function is never infinitely sharp, but has a finite width on account of interactions between excitations causing scattering and / or decay. In the approximation <a href="#eq-sma" class="quarto-xref">Equation&nbsp;26</a>, often known as the <strong>single mode approximation</strong>, the f-sum rule tells us that</p>
<p><span class="math display">\[
S_\rho(\mathbf{q}) = \frac{N\mathbf{q}^2}{2m\omega(\mathbf{q})}.
\]</span></p>
<p>Let’s consider two important cases. First, suppose <span class="math inline">\(\omega(\mathbf{q}) = \frac{\mathbf{q}^2}{2m}\)</span>. This would be the case in a Bose condensate with strictly no interactions, so that excitations out of the condensate are free particles. Then</p>
<p><span class="math display">\[
S_\rho(\mathbf{q}) = N.
\]</span></p>
<p>This result corresponds to completely uncorrelated particle positions (Poisson statistics).</p>
<p>Second, suppose <span class="math inline">\(\omega(\mathbf{q}) = c|\mathbf{q}|\)</span> i.e.&nbsp;linear dispersion with finite speed of sound. Then</p>
<p><span class="math display">\[
S_\rho(\mathbf{q}) = \frac{N|\mathbf{q}|}{2mc}.
\]</span></p>
<p>In this case the density fluctuations vanish as the wavevector goes to zero, indicating long-range correlations between positions in the ground state.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>Check the compressibility sum rule in these two cases.</p>
</div>
</div>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-chaikin2000principles" class="csl-entry" role="listitem">
Chaikin, PM, and TC Lubensky. 2000. <em>Principles of Condensed Matter Physics</em>. Cambridge University Press.
</div>
<div id="ref-nazarov2013advanced" class="csl-entry" role="listitem">
Nazarov, Yuli V, and Jeroen Danon. 2013. <em>Advanced Quantum Mechanics: A Practical Guide</em>. Cambridge University Press.
</div>
<div id="ref-nozieres2018theory" class="csl-entry" role="listitem">
Nozieres, Philippe. 2018. <em>Theory of Quantum Liquids: Superfluid Bose Liquids</em>. CRC Press.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../notes/superconductivity.html" class="pagination-link" aria-label="Superconductivity">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Superconductivity</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../slides/many-body-wavefunctions.html" class="pagination-link" aria-label="Many Body Wavefunctions">
        <span class="nav-page-text">Many Body Wavefunctions</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>